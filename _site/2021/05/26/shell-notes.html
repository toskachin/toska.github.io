<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
    <meta http-equiv="Content-Language" content="zh-CN" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- 360 -->
    <meta name="360-site-verification" content="fa6ca3a9a0330e9cecabee0a9fe1d52a" />
    <!-- 搜狗 -->
    <meta name="sogou_site_verification" content="oatSp9uAV5" />
    <!--熊掌号 -->
    <meta name="baidu-site-verification" content="Wkb0Jzk8yx" />
    <!-- Google Search Console -->
    <meta name="google-site-verification" content="IJrXvaK-Luj-lCGP7tymcCbkcfMKi82Y8V21qN9ZT0s" />
    <title>
        
            shell从入门到放弃
        
    </title>
    <link rel="shortcut icon" type="image/x-icon" href="/assets/img/favicon.ico">
    
    <link rel="stylesheet" href="/assets/css/materialize.min.css">
    <link rel="stylesheet" href="/assets/css/icons.css">
    

    
        
        <link rel="stylesheet" href="/assets/css/page.css">
        
    
        
        <link rel="stylesheet" href="/assets/css/post.css">
        
    
        
        <link rel="stylesheet" href="/assets/css/syntax.css">
        
    
        
        <link rel="stylesheet" href="/assets/css/article-category.css">
        
    

    
    <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml">
    <link rel="sitemap" type="application/xml" title="Sitemap" href="/sitemap.xml">	
    <!-- Begin Jekyll SEO tag v2.7.1 -->
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="shell从入门到放弃" />
<meta property="og:locale" content="zh_CN" />
<meta name="description" content="shell手册" />
<meta property="og:description" content="shell手册" />
<link rel="canonical" href="http://localhost:4000/2021/05/26/shell-notes" />
<meta property="og:url" content="http://localhost:4000/2021/05/26/shell-notes" />
<meta property="og:site_name" content="TOSKA'S BLOG" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-05-26T00:00:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="shell从入门到放弃" />
<script type="application/ld+json">
{"headline":"shell从入门到放弃","dateModified":"2021-05-26T00:00:00+08:00","description":"shell手册","datePublished":"2021-05-26T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2021/05/26/shell-notes"},"url":"http://localhost:4000/2021/05/26/shell-notes","@type":"BlogPosting","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
    <header>
        <nav class="top-nav">
            
            <div class="nav-wrapper">
                <div class="container">
                    
                    <a class="page-title" href="/">TOSKA'S BLOG</a>
                    <p class="head-message">Stay Hungry&nbsp;&nbsp;Stay Foolish</p>
                </div>
            </div>
        </nav>

        <div class="container">
            <a href="#" data-target="slide-out" class="sidenav-trigger top-nav full hide-on-large-only">
                <i class="material-icons">menu</i>
            </a>
        </div>
        <ul id="slide-out" class="sidenav sidenav-fixed" style="background-color:#ddd">
            <li>
                <div class="userView">
                    <img class="user-bg" src="/assets/img/bg.png" />
                    <a class="user-avatar" href="https://github.com/toskachin" target="_blank">
                        <img class="circle z-depth-2" src="/assets/img/user.png" width="64" />
                    </a>
                    <div class="white-text user-info">
                        toska <i>(RJ)<I><BRr><I><BR
                        royjin@msn.com
                    </div>
                </div>
            </li>
            <li><a class="waves-effect" href="/"><i class="material-icons">home</i>Home - 主页</a></li>
            <li><a class="waves-effect" href="/projects"><i class="material-icons">description</i>Github - 项目</a></li>
            <li><a class="waves-effect" href="/categories"><i class="material-icons">sort</i>Categories - 目录</a></li>
            <li><a class="waves-effect" href="/tags"><i class="material-icons">label</i>Tags - 标签</a></li>
            <!-- <li><a class="waves-effect" href="/feed.xml" target="_blank"><i class="material-icons">rss_feed</i>RSS - 订阅</a></li> -->
            <li><a class="waves-effect" href="/about"><i class="material-icons">person</i>About - 关于我</a></li>
            <li><a class="waves-effect" href="/contact"><i class="material-icons">email</i>Contact - 联系我</a></li>
            <!-- 华为云广告 -->
            <li class="ad">
                <!-- <a href="https://mp.weixin.qq.com/s/ujUoHc3grjO8LD_Bg1fckA" target="_blank"> -->
                <!-- <a href="https://mp.weixin.qq.com/s/MTbMlhjAx8R4fc8Po90EXg" target="_blank">
                    <img src="/assets/img/ad-huaweiyun.png" alt="" width="100%" />
                </a>
                <i class="material-icons" onclick="javascript:this.parentNode.style.display='none';">close</i> -->
            </li>
        </ul>
    </header>
    <main>

<div class="container">
    <div id="page-info">
        <h1 class="page-title white-text">shell从入门到放弃</h1>
    </div>
    <div id="page-content" class="row">
        <div id="post-info">
    <ul class="collapsible hoverable" data-collapsible="accordion">
        <li>
            <div class="collapsible-header grey lighten-4">
                <span>
                    <i class="material-icons tooltipped" data-position="left" data-delay="30" data-tooltip="Date">date_range</i>
                    26/05/2021 00:00<br />
                    <div id="busuanzi_container_site_pv">点击量：<span style="display: inline;" id="busuanzi_value_page_pv"></span>次</div>
                    <i id="indicate" class="right material-icons tooltipped" data-position="left" data-delay="30"
                        data-tooltip="Show extra info">info</i>
                </span>
            </div>
            <div class="collapsible-body">
                <span>
                    <i class="material-icons tooltipped" data-position="left" data-delay="30" data-tooltip="Categories">sort</i>
                    
                    
                    
                    <a href="/categories#linux_cap"
                        target="_blank">
                        <div class="chip">Linux</div>
                    </a>
                    
                </span>
                <span>
                    <i class="material-icons tooltipped" data-position="left" data-delay="30" data-tooltip="Tags">label</i>
                    
                    
                    
                    <a href="/tags#tech" target="_blank">
                        <div class="chip">tech</div>
                    </a>
                    
                </span>
            </div>
        </li>
    </ul>
</div>
<div class="divider"></div>
<div id="post-content" class="row">
    <div class="col s12">
        <ul>
  <li><a href="#变量">变量</a>
    <ul>
      <li><a href="#局部变量">局部变量</a></li>
      <li><a href="#环境变量">环境变量</a></li>
      <li><a href="#位置参数">位置参数</a></li>
    </ul>
  </li>
  <li><a href="#特殊符号">特殊符号</a>
    <ul>
      <li><a href="#括弧">括弧</a>
        <ul>
          <li><a href="#小括号">小括号</a></li>
          <li><a href="#大括号">大括号</a></li>
        </ul>
      </li>
      <li><a href="#命令执行和区别">命令执行()和{}区别</a></li>
      <li><a href="#单引号双引号反引号">单引号双引号反引号</a></li>
      <li><a href="#命令序列">命令序列</a></li>
    </ul>
  </li>
  <li><a href="#条件语句">条件语句</a>
    <ul>
      <li><a href="#基元和组合表达式">基元和组合表达式</a></li>
      <li><a href="#if-statement"><code class="language-plaintext highlighter-rouge">if</code> statement</a></li>
      <li><a href="#case"><code class="language-plaintext highlighter-rouge">case</code></a></li>
    </ul>
  </li>
  <li><a href="#循环">循环</a>
    <ul>
      <li><a href="#for-loop"><code class="language-plaintext highlighter-rouge">for</code> loop</a></li>
      <li><a href="#while-loop"><code class="language-plaintext highlighter-rouge">while</code> loop</a></li>
      <li><a href="#until"><code class="language-plaintext highlighter-rouge">until</code></a></li>
      <li><a href="#循环控制">循环控制</a></li>
    </ul>
  </li>
  <li><a href="#数组">数组</a></li>
  <li><a href="#函数">函数</a></li>
  <li><a href="#shell-扩展">shell 扩展</a>
    <ul>
      <li><a href="#bash-下的-split-取数组的首尾">bash 下的 split 取“数组”的首、尾：</a></li>
      <li><a href="#bash-下的-replace-与-replaceall">bash 下的 replace 与 replaceAll</a></li>
      <li><a href="#bash-下的变量空值检测与初始化">bash 下的变量空值检测与初始化</a></li>
      <li><a href="#bash-下的大小写变换">bash 下的大小写变换</a></li>
    </ul>
  </li>
  <li><a href="#reference">Reference</a></li>
</ul>

<h1 id="变量">变量</h1>
<h2 id="局部变量">局部变量</h2>
<p><strong>局部变量</strong> 是仅在某个脚本内部有效的变量。它们不能被其他的程序和脚本访问。</p>

<p>局部变量可以用<code class="language-plaintext highlighter-rouge">=</code>声明（作为一种约定，变量名、<code class="language-plaintext highlighter-rouge">=</code>、变量的值之间 <strong>不应该</strong> 有空格），其值可以用<code class="language-plaintext highlighter-rouge">$</code>访问到。举个例子：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">username</span><span class="o">=</span><span class="s2">"denysdovhan"</span>  <span class="c"># 声明变量</span>
<span class="nb">echo</span> <span class="nv">$username</span>          <span class="c"># 输出变量的值</span>
<span class="nb">unset </span>username          <span class="c"># 删除变量</span>
</code></pre></div></div>
<p>我们可以用<code class="language-plaintext highlighter-rouge">local</code>关键字声明属于某个函数的局部变量。这样声明的变量会在函数结束时消失。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">local </span><span class="nv">local_var</span><span class="o">=</span><span class="s2">"I'm a local value"</span>
</code></pre></div></div>

<h2 id="环境变量">环境变量</h2>

<p><strong>环境变量</strong> 是对当前shell会话内所有的程序或脚本都可见的变量。创建它们跟创建局部变量类似，但使用的是<code class="language-plaintext highlighter-rouge">export</code>关键字。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">export </span><span class="nv">GLOBAL_VAR</span><span class="o">=</span><span class="s2">"I'm a global variable"</span>
</code></pre></div></div>
<p>bash中有 <em>非常多</em> 的环境变量。你会非常频繁地遇到它们，这里有一张速查表，记录了在实践中最常见的环境变量。</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Variable</th>
      <th style="text-align: left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">$HOME</code></td>
      <td style="text-align: left">当前用户的用户目录</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">$PATH</code></td>
      <td style="text-align: left">用分号分隔的目录列表，shell会到这些目录中查找命令</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">$PWD</code></td>
      <td style="text-align: left">当前工作目录</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">$RANDOM</code></td>
      <td style="text-align: left">0到32767之间的整数</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">$UID</code></td>
      <td style="text-align: left">数值类型，当前用户的用户ID</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">$PS1</code></td>
      <td style="text-align: left">主要系统输入提示符</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">$PS2</code></td>
      <td style="text-align: left">次要系统输入提示符</td>
    </tr>
  </tbody>
</table>

<h2 id="位置参数">位置参数</h2>

<p><strong>位置参数</strong> 是在调用一个函数并传给它参数时创建的变量。下表列出了在函数中，位置参数变量和一些其它的特殊变量以及它们的意义。</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Parameter</th>
      <th style="text-align: left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">$0</code></td>
      <td style="text-align: left">脚本名称</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">$1 … $9</code></td>
      <td style="text-align: left">第1个到第9个参数列表</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">${10} … ${N}</code></td>
      <td style="text-align: left">第10个到N个参数列表</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">$*</code> or <code class="language-plaintext highlighter-rouge">$@</code></td>
      <td style="text-align: left">除了<code class="language-plaintext highlighter-rouge">$0</code>外的所有位置参数</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">$#</code></td>
      <td style="text-align: left">不包括<code class="language-plaintext highlighter-rouge">$0</code>在内的位置参数的个数</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">$FUNCNAME</code></td>
      <td style="text-align: left">函数名称（仅在函数内部有值）</td>
    </tr>
  </tbody>
</table>

<p>在下面的例子中，位置参数为：<code class="language-plaintext highlighter-rouge">$0='./script.sh'</code>，<code class="language-plaintext highlighter-rouge">$1='foo'</code>，<code class="language-plaintext highlighter-rouge">$2='bar'</code>：</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./script.sh foo bar
</code></pre></div></div>

<p>变量可以有 <em>默认</em> 值。我们可以用如下语法来指定默认值：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="c"># 如果变量为空，赋给他们默认值</span>
: <span class="k">${</span><span class="nv">VAR</span>:<span class="p">=</span><span class="s1">'default'</span><span class="k">}</span>
: <span class="k">${</span><span class="nv">$1</span>:<span class="p">=</span><span class="s1">'first'</span><span class="k">}</span>
<span class="c"># 或者</span>
<span class="nv">FOO</span><span class="o">=</span><span class="k">${</span><span class="nv">FOO</span><span class="k">:-</span><span class="s1">'default'</span><span class="k">}</span>
</code></pre></div></div>

<h1 id="特殊符号">特殊符号</h1>
<h2 id="括弧">括弧</h2>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[]</span> <span class="c">#test命令的alias,里面不可以用比较符，比如=，所以有-ne -eq etc.</span>

<span class="nv">$[</span><span class="o">]</span> <span class="c">#现在几乎不用了，忽略</span>

<span class="o">[[</span> <span class="o">]]</span> <span class="c">#[]可以用的它可以用，还可以 &amp;&amp; 和 ||，还可以搞正则表达式</span>

<span class="o">()</span> <span class="c">#( COMMAND [; ...] )把命令包起来，在subshell里面运行，你切换目录什么不会影响到这一层</span>

<span class="si">$()</span> <span class="c">#$( COMMAND [; ...] )执行命令的结果，比如$(ls)和ls一样</span>

<span class="o">((</span> <span class="o">))</span> <span class="c">#整数运算， (( a &gt; 0 ))、(( a = ((c = 5) / 2) &lt;&lt; 3 ))、(( 5 * 6 % 2)) 之类的全都行。算完了之后给你返回一个值，也就是 0 是假，其余全部是真。</span>

<span class="k">$((</span> <span class="k">))</span> <span class="c">#基本不用了，和(())差不多，区别是把运算结果输出，比如[ $(( a % 2)) -ne 0 ] </span>

<span class="o">{}</span> <span class="c"># { COMMAND; [... COMMAND; ] } 一个不把命令放在 subshell 里面的包裹。这样你可以重定向一堆命令的输入或者输出，但是仍然可以修改变量</span>

<span class="k">${}</span> <span class="c">#常用语划分变量名字区间  比如 ${_name}</span>
</code></pre></div></div>

<p>引用其他blog介绍</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>2.1 <span class="o">()</span> 在子shell中运行
    <span class="o">(</span><span class="nv">a</span><span class="o">=</span>1<span class="o">)</span><span class="p">;</span><span class="nb">echo</span> <span class="nv">$a</span>，结果是空，因为a<span class="o">=</span>1不是在当前shell中运行的<span class="o">(</span><span class="nv">a</span><span class="o">=</span>1<span class="o">)</span><span class="p">;</span><span class="o">(</span><span class="nb">echo</span> <span class="nv">$a</span><span class="o">)</span>也是空的。
    小技巧：<span class="o">(</span><span class="nb">cd</span> <span class="nv">$path</span>, <span class="k">do </span>something<span class="o">)</span> 可以让不切换当前目录而在其它目录干点别的事儿~
    <span class="o">()</span> 还有个功能是数组的赋值：比如a<span class="o">=(</span>1 3 5<span class="o">)</span>，那么<span class="k">${</span><span class="nv">a</span><span class="p">[0]</span><span class="k">}</span><span class="o">=</span>1<span class="p">;</span><span class="k">${</span><span class="nv">a</span><span class="p">[1]</span><span class="k">}</span><span class="o">=</span>3<span class="p">;</span><span class="k">${</span><span class="nv">a</span><span class="p">[2]</span><span class="k">}</span><span class="o">=</span>5，需要注意的是，下标是从0开始的。
    
2.2 <span class="o">(())</span> 表达式计算
    <span class="nv">a</span><span class="o">=</span>1<span class="p">;</span><span class="o">((</span>a++<span class="o">))</span><span class="p">;</span><span class="nb">echo</span> <span class="nv">$a</span>，这时a就是2了。
    
2.3 &lt;<span class="o">()</span> 和 <span class="o">&gt;()</span> 进程代入，可以把命令的执行结果当成文件一样读入
    比如comm前一般需要sort，那就可以这样comm &lt;<span class="o">(</span><span class="nb">sort </span>1.lst<span class="o">)</span> &lt;<span class="o">(</span><span class="nb">sort </span>2.lst<span class="o">)</span>
    或者是paste &lt;<span class="o">(</span><span class="nb">cut</span> <span class="nt">-t2</span> file1<span class="o">)</span> &lt;<span class="o">(</span><span class="nb">cut</span> <span class="nt">-t1</span> file1<span class="o">)</span>，和管道差不多，但是支持多个输入。

2.4 <span class="si">$()</span> <span class="si">$(</span>cmd<span class="si">)</span> 执行cmd的结果，
    比如cmd是echo <span class="nb">ls</span>，那么就是执行ls，比如file <span class="si">$(</span>which bash<span class="si">)</span>，which bash的结果是/bin/bash，
    所以file <span class="si">$(</span>which bash<span class="si">)</span>等于file /bin/bash。如果你<span class="si">$(</span><span class="nb">ls</span><span class="si">)</span>，而且你的当前目录下只有a b两个文件，
    那么就是执行a b，然后系统会提示，命令没找到。<span class="si">$()</span> 基本和 <span class="sb">``</span> 等价。
    
2.5 <span class="k">$(())</span> 表达式扩展，
    和<span class="o">(())</span>很相似，但是这个是有点不同，<span class="k">$(())</span>不能直接<span class="k">$((</span>b++<span class="k">))</span>，例如：b<span class="o">=</span>1<span class="p">;</span><span class="nb">echo</span> <span class="k">$((</span><span class="o">++</span>b<span class="k">))</span>
    这时b等于2，显示的也是2，b<span class="o">=</span>1<span class="p">;</span> <span class="nb">echo</span> <span class="k">$((</span>b++<span class="k">))</span>这时b等于2，显示的是1.
    
2.6 <span class="o">[]</span> 和 <span class="o">[[]]</span>，[] 就是 <span class="nb">test</span>，[]和[[]]都是条件表达式，不过[[]]有比[]高的容错性，
    如果a为空，那么[ <span class="nv">$a</span> <span class="nt">-eq</span> 0 <span class="o">]</span>会报错，但是[[ <span class="nv">$a</span> <span class="nt">-eq</span> 0 <span class="o">]]</span>不会，所以一般都会使用[[]]或者是
    <span class="o">[</span> <span class="s2">"</span><span class="nv">$a</span><span class="s2">"</span> <span class="nt">-eq</span> 0 <span class="o">]</span>，[[]]支持的功能也比 <span class="o">[]</span> 多，比如[[ aaa <span class="o">=</span>~ a<span class="o">{</span>3<span class="o">}</span> <span class="o">]]</span>，[] 还有一种用途，
    如果你的当前目录下有a1-a9九个文件，你可以用a[1-9]来替代这九个文件。
    有点需要注意，你不能用a[1-20]来代替a1- a20，必须要a[1-9] a1[0-9] a20。
    但是需要注意的是 <span class="o">[[]]</span> 数字进制转换的坑~
    
2.7 <span class="nv">$[</span><span class="o">]</span> 是 <span class="k">$(())</span> 的过去形式，现在已经不建议使用。

2.8 <span class="o">{</span>n..m<span class="o">}</span> <span class="o">{</span>1..30<span class="o">}</span> 就是1-30，或者是/<span class="o">{</span>,s<span class="o">}</span>bin/表示/bin/和/sbin/，ab<span class="o">{</span>c,d,e<span class="o">}</span>表示abc、abd、abe，
    小技巧：文件备份：cp a.sh<span class="o">{</span>,.bak<span class="o">}</span>
    而 <span class="o">{</span> cmd1<span class="p">;</span> cmd2<span class="p">;</span> <span class="o">}</span> 的作用是定义一个命令组，一般用在单行的条件表达式中：
    <span class="o">[[</span> 1 <span class="nt">-eq</span> 2 <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">echo </span>True <span class="o">||</span> <span class="o">{</span> <span class="nb">echo </span>False<span class="p">;</span> <span class="nb">echo</span> <span class="s2">"Program will exit！"</span><span class="p">;</span> <span class="o">}</span>
    其实 shell 函数的语法也是它的变体：
    a<span class="o">(){</span> <span class="nv">i</span><span class="o">=</span><span class="nv">$1</span><span class="p">;</span> <span class="nb">echo</span> <span class="k">$((</span>i++<span class="k">))</span><span class="p">;</span> <span class="nb">echo</span> <span class="k">$((</span><span class="o">++</span>i<span class="k">))</span><span class="p">;</span> <span class="o">}</span> <span class="o">&amp;&amp;</span> a 1

2.9 <span class="k">${}</span> 变量的Parameter Expansion，用法很多，最基本的 <span class="k">${</span><span class="nv">var</span><span class="k">}</span>，防止变量扩展冲突，具体可以查看man bash。  
    <span class="o">&amp;&amp;</span> <span class="o">{</span> COMMAND<span class="p">;</span> <span class="o">[</span>... COMMAND<span class="p">;</span> <span class="o">]</span> <span class="o">}</span> 一个不把命令放在 subshell 里面的包裹。这样你可以重定向一堆命令的输入或者输出，但是仍然可以修改变量
</code></pre></div></div>

<h3 id="小括号">小括号</h3>
<p>()：用于一串命令的执行时，()中的命令会在子shell中运行。
$():和反引号作用一样，用来引用系统命令。</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">now</span><span class="o">=</span><span class="sb">`</span><span class="nb">date</span> +%T<span class="sb">`</span>
<span class="c"># or</span>
<span class="nv">now</span><span class="o">=</span><span class="si">$(</span><span class="nb">date</span> +%T<span class="si">)</span>

<span class="nb">echo</span> <span class="nv">$now</span> <span class="c"># 11:08:00</span>
</code></pre></div></div>
<p>算数扩展</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">result</span><span class="o">=</span><span class="k">$((</span> <span class="o">((</span><span class="m">10</span> <span class="o">+</span> <span class="m">5</span><span class="o">*</span><span class="m">3</span><span class="o">)</span> <span class="o">-</span> <span class="m">7</span><span class="o">)</span> <span class="o">/</span> <span class="m">2</span> <span class="k">))</span>
<span class="nb">echo</span> <span class="nv">$result</span> <span class="c"># 9</span>
</code></pre></div></div>
<h3 id="大括号">大括号</h3>
<p>生成字符串</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo </span>beg<span class="o">{</span>i,a,u<span class="o">}</span>n <span class="c"># begin began begun</span>
<span class="nb">echo</span> <span class="o">{</span>0..5<span class="o">}</span> <span class="c">#0 1 2 3 4 5</span>
<span class="nb">echo</span> <span class="o">{</span>00..8..2<span class="o">}</span> <span class="c"># 00 02 04 06 08</span>
</code></pre></div></div>
<p>{}变量命名，引用</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#可以加{}也可以不加，{}有助于识别边界</span>
<span class="nv">your_name</span><span class="o">=</span><span class="s2">"hello"</span>
<span class="nb">echo</span> <span class="k">${</span><span class="nv">your_name</span><span class="k">}</span>
hello
<span class="nb">echo</span> <span class="nv">$your_name</span>
hello
</code></pre></div></div>
<p>[]:用于变量的测试。
[[]]:带特殊字符的测试</p>
<h2 id="命令执行和区别">命令执行()和{}区别</h2>
<p>()和{}都是对一串的命令进行执行,但有所区别：</p>

<ul>
  <li>相同点：
()和{}都是把一串的命令放在括号里面,并且命令之间用;号隔开</li>
  <li>不同点
()只是对一串命令重新开一个子shell进行执行,{}对一串命令在当前shell执行
()最后一个命令可以不用分号,{}最后一个命令要用分号
()里的第一个命令和左边括号不必有空格,{}的第一个命令和左括号之间必须要有一个空格
()和{}中括号里面的某个命令的重定向只影响该命令,但括号外的重定向则影响到括号里的所有命令
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>root@corp-centos-101 ~]# <span class="nv">var</span><span class="o">=</span>tes01
<span class="o">[</span>root@corp-centos-101 ~]# <span class="nb">echo</span> <span class="nv">$var</span>
tes01
<span class="o">[</span>root@corp-centos-101 ~]# <span class="o">(</span><span class="nv">var</span><span class="o">=</span>test2<span class="p">;</span><span class="nb">echo</span> <span class="nv">$var</span><span class="o">)</span>
test2
<span class="o">[</span>root@corp-centos-101 ~]# <span class="nb">echo</span> <span class="nv">$var</span>
tes01
<span class="o">[</span>root@corp-centos-101 ~]# <span class="o">{</span> <span class="nv">var</span><span class="o">=</span>test2<span class="p">;</span><span class="nb">echo</span> <span class="nv">$var</span><span class="p">;</span> <span class="o">}</span>
test2
<span class="o">[</span>root@corp-centos-101 ~]# <span class="nb">echo</span> <span class="nv">$var</span>
test2
</code></pre></div>    </div>
    <p>在{}中 第一个命令和{之间必须有空格,结束必须有;</p>
  </li>
</ul>

<p>{}中的修改了$var的值 说明在当前shell执行</p>

<h2 id="单引号双引号反引号">单引号双引号反引号</h2>
<p>单引号</p>
<ul>
  <li>单引号里的任何字符都会原样输出，单引号字符串中的变量是无效的；</li>
  <li>单引号字串中不能出现单引号（对单引号使用转义符后也不行）</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">name</span><span class="o">=</span><span class="s2">"old boy"</span>
<span class="nb">echo</span> <span class="s2">"</span><span class="nv">$name</span><span class="s2">"</span>
old boy
<span class="nb">echo</span> <span class="s1">'#name'</span>
<span class="c">#name</span>
</code></pre></div></div>

<p>双引号</p>
<ul>
  <li>双引号里可以有变量</li>
  <li>双引号里可以出现转义字符</li>
</ul>

<p>反引号<code class="language-plaintext highlighter-rouge"> </code></p>
<ul>
  <li>用来执行系统命令</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">local_time</span><span class="o">=</span><span class="sb">`</span><span class="nb">date</span><span class="sb">`</span>
<span class="nb">echo</span> <span class="nv">$local_time</span>
Wed Mar 17 20:19:30 EDT 2021
bash
</code></pre></div></div>

<p><em>区别</em>
单引号和双引号之间有很重要的区别。在双引号中，变量引用或者命令置换是会被展开的。在单引号中是不会的。举个例子：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s2">"Your home: </span><span class="nv">$HOME</span><span class="s2">"</span> <span class="c"># Your home: /Users/&lt;username&gt;</span>
<span class="nb">echo</span> <span class="s1">'Your home: $HOME'</span> <span class="c"># Your home: $HOME</span>
</code></pre></div></div>

<p>当局部变量和环境变量包含空格时，它们在引号中的扩展要格外注意。随便举个例子，假如我们用<code class="language-plaintext highlighter-rouge">echo</code>来输出用户的输入：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">INPUT</span><span class="o">=</span><span class="s2">"A string  with   strange    whitespace."</span>
<span class="nb">echo</span> <span class="nv">$INPUT</span>   <span class="c"># A string with strange whitespace.</span>
<span class="nb">echo</span> <span class="s2">"</span><span class="nv">$INPUT</span><span class="s2">"</span> <span class="c"># A string  with   strange    whitespace.</span>
</code></pre></div></div>

<p>调用第一个<code class="language-plaintext highlighter-rouge">echo</code>时给了它5个单独的参数 —— $INPUT被分成了单独的词，<code class="language-plaintext highlighter-rouge">echo</code>在每个词之间打印了一个空格。第二种情况，调用<code class="language-plaintext highlighter-rouge">echo</code>时只给了它一个参数（整个$INPUT的值，包括其中的空格）。</p>

<p>来看一个更严肃的例子：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">FILE</span><span class="o">=</span><span class="s2">"Favorite Things.txt"</span>
<span class="nb">cat</span> <span class="nv">$FILE</span>   <span class="c"># 尝试输出两个文件: `Favorite` 和 `Things.txt`</span>
<span class="nb">cat</span> <span class="s2">"</span><span class="nv">$FILE</span><span class="s2">"</span> <span class="c"># 输出一个文件: `Favorite Things.txt`</span>
</code></pre></div></div>

<p>尽管这个问题可以通过把FILE重命名成<code class="language-plaintext highlighter-rouge">Favorite-Things.txt</code>来解决，但是，假如这个值来自某个环境变量，来自一个位置参数，或者来自其它命令（<code class="language-plaintext highlighter-rouge">find</code>, <code class="language-plaintext highlighter-rouge">cat</code>, 等等）呢。因此，如果输入 <em>可能</em> 包含空格，务必要用引号把表达式包起来。</p>

<h2 id="命令序列">命令序列</h2>

<p>命令序列是由<code class="language-plaintext highlighter-rouge">;</code>，<code class="language-plaintext highlighter-rouge">&amp;</code>，<code class="language-plaintext highlighter-rouge">&amp;&amp;</code>或者<code class="language-plaintext highlighter-rouge">||</code>运算符分隔的一个或多个管道序列。</p>

<p>如果一个命令以<code class="language-plaintext highlighter-rouge">&amp;</code>结尾，shell将会在一个子shell中异步执行这个命令。换句话说，这个命令将会在后台执行。</p>

<p>以<code class="language-plaintext highlighter-rouge">;</code>分隔的命令将会依次执行：一个接着一个。shell会等待直到每个命令执行完。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># command2 会在 command1 之后执行</span>
command1 <span class="p">;</span> command2

<span class="c"># 等同于这种写法</span>
command1
command2
</code></pre></div></div>

<p>以<code class="language-plaintext highlighter-rouge">&amp;&amp;</code>和<code class="language-plaintext highlighter-rouge">||</code>分隔的命令分别叫做 <em>与</em> 和 <em>或</em> 序列。</p>

<p><em>与序列</em> 看起来是这样的：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 当且仅当command1执行成功（返回0值）时，command2才会执行</span>
command1 <span class="o">&amp;&amp;</span> command2
</code></pre></div></div>

<p><em>或序列</em> 是下面这种形式：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 当且仅当command1执行失败（返回错误码）时，command2才会执行</span>
command1 <span class="o">||</span> command2
</code></pre></div></div>

<p><em>与</em> 或 <em>或</em> 序列的返回值是序列中最后一个执行的命令的返回值。</p>

<h1 id="条件语句">条件语句</h1>

<p>跟其它程序设计语言一样，Bash中的条件语句让我们可以决定一个操作是否被执行。结果取决于一个包在<code class="language-plaintext highlighter-rouge">[[ ]]</code>里的表达式。</p>

<p>条件表达式可以包含<code class="language-plaintext highlighter-rouge">&amp;&amp;</code>和<code class="language-plaintext highlighter-rouge">||</code>运算符，分别对应 <em>与</em> 和 <em>或</em> 。除此之外还有很多有用的<a href="#基元和组合表达式">表达式</a>。</p>

<p>共有两个不同的条件表达式：<code class="language-plaintext highlighter-rouge">if</code>和<code class="language-plaintext highlighter-rouge">case</code>。</p>
<h2 id="基元和组合表达式">基元和组合表达式</h2>

<p>由<code class="language-plaintext highlighter-rouge">[[ ]]</code>（<code class="language-plaintext highlighter-rouge">sh</code>中是<code class="language-plaintext highlighter-rouge">[ ]</code>）包起来的表达式被称作 <strong>检测命令</strong> 或 <strong>基元</strong>。这些表达式帮助我们检测一个条件的结果。在下面的表里，为了兼容<code class="language-plaintext highlighter-rouge">sh</code>，我们用的是<code class="language-plaintext highlighter-rouge">[ ]</code>。这里可以找到有关<a href="http://serverfault.com/a/52050">bash中单双中括号区别</a>的答案。</p>

<p><strong>跟文件系统相关：</strong></p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">基元</th>
      <th style="text-align: left">含义</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">[ -e FILE ]</code></td>
      <td style="text-align: left">如果<code class="language-plaintext highlighter-rouge">FILE</code>存在 (<strong>e</strong>xists)，为真</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">[ -f FILE ]</code></td>
      <td style="text-align: left">如果<code class="language-plaintext highlighter-rouge">FILE</code>存在且为一个普通文件（<strong>f</strong>ile），为真</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">[ -d FILE ]</code></td>
      <td style="text-align: left">如果<code class="language-plaintext highlighter-rouge">FILE</code>存在且为一个目录（<strong>d</strong>irectory），为真</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">[ -s FILE ]</code></td>
      <td style="text-align: left">如果<code class="language-plaintext highlighter-rouge">FILE</code>存在且非空（<strong>s</strong>ize 大于0），为真</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">[ -r FILE ]</code></td>
      <td style="text-align: left">如果<code class="language-plaintext highlighter-rouge">FILE</code>存在且有读权限（<strong>r</strong>eadable），为真</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">[ -w FILE ]</code></td>
      <td style="text-align: left">如果<code class="language-plaintext highlighter-rouge">FILE</code>存在且有写权限（<strong>w</strong>ritable），为真</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">[ -x FILE ]</code></td>
      <td style="text-align: left">如果<code class="language-plaintext highlighter-rouge">FILE</code>存在且有可执行权限（e<strong>x</strong>ecutable），为真</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">[ -L FILE ]</code></td>
      <td style="text-align: left">如果<code class="language-plaintext highlighter-rouge">FILE</code>存在且为一个符号链接（<strong>l</strong>ink），为真</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">[ FILE1 -nt FILE2 ]</code></td>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">FILE1</code>比<code class="language-plaintext highlighter-rouge">FILE2</code>新（<strong>n</strong>ewer <strong>t</strong>han）</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">[ FILE1 -ot FILE2 ]</code></td>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">FILE1</code>比<code class="language-plaintext highlighter-rouge">FILE2</code>旧（<strong>o</strong>lder <strong>t</strong>han）</td>
    </tr>
  </tbody>
</table>

<p><strong>跟字符串相关：</strong></p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">基元</th>
      <th style="text-align: left">含义</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">[ -z STR ]</code></td>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">STR</code>为空（长度为0，<strong>z</strong>ero）</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">[ -n STR ]</code></td>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">STR</code>非空（长度非0，<strong>n</strong>on-zero）</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">[ STR1 == STR2 ]</code></td>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">STR1</code>和<code class="language-plaintext highlighter-rouge">STR2</code>相等</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">[ STR1 != STR2 ]</code></td>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">STR1</code>和<code class="language-plaintext highlighter-rouge">STR2</code>不等</td>
    </tr>
  </tbody>
</table>

<p><strong>算数二元运算符：</strong></p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">基元</th>
      <th style="text-align: left">含义</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">[ ARG1 -eq ARG2 ]</code></td>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">ARG1</code>和<code class="language-plaintext highlighter-rouge">ARG2</code>相等（<strong>eq</strong>ual）</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">[ ARG1 -ne ARG2 ]</code></td>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">ARG1</code>和<code class="language-plaintext highlighter-rouge">ARG2</code>不等（<strong>n</strong>ot <strong>e</strong>qual）</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">[ ARG1 -lt ARG2 ]</code></td>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">ARG1</code>小于<code class="language-plaintext highlighter-rouge">ARG2</code>（<strong>l</strong>ess <strong>t</strong>han）</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">[ ARG1 -le ARG2 ]</code></td>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">ARG1</code>小于等于<code class="language-plaintext highlighter-rouge">ARG2</code>（<strong>l</strong>ess than or <strong>e</strong>qual）</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">[ ARG1 -gt ARG2 ]</code></td>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">ARG1</code>大于<code class="language-plaintext highlighter-rouge">ARG2</code>（<strong>g</strong>reater <strong>t</strong>han）</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">[ ARG1 -ge ARG2 ]</code></td>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">ARG1</code>大于等于<code class="language-plaintext highlighter-rouge">ARG2</code>（<strong>g</strong>reater than or <strong>e</strong>qual）</td>
    </tr>
  </tbody>
</table>

<p>条件语句可以跟 <strong>组合表达式</strong> 配合使用：</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">Operation</th>
      <th style="text-align: left">Effect</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">[ ! EXPR ]</code></td>
      <td style="text-align: left">如果<code class="language-plaintext highlighter-rouge">EXPR</code>为假，为真</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">[ (EXPR) ]</code></td>
      <td style="text-align: left">返回<code class="language-plaintext highlighter-rouge">EXPR</code>的值</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">[ EXPR1 -a EXPR2 ]</code></td>
      <td style="text-align: left">逻辑 <em>与</em>， 如果<code class="language-plaintext highlighter-rouge">EXPR1</code>和（<strong>a</strong>nd）<code class="language-plaintext highlighter-rouge">EXPR2</code>都为真，为真</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">[ EXPR1 -o EXPR2 ]</code></td>
      <td style="text-align: left">逻辑 <em>或</em>， 如果<code class="language-plaintext highlighter-rouge">EXPR1</code>或（<strong>o</strong>r）<code class="language-plaintext highlighter-rouge">EXPR2</code>为真，为真</td>
    </tr>
  </tbody>
</table>

<h2 id="if-statement"><code class="language-plaintext highlighter-rouge">if</code> statement</h2>

<p><code class="language-plaintext highlighter-rouge">if</code>在使用上跟其它语言相同。如果中括号里的表达式为真，那么<code class="language-plaintext highlighter-rouge">then</code>和<code class="language-plaintext highlighter-rouge">fi</code>之间的代码会被执行。<code class="language-plaintext highlighter-rouge">fi</code>标志着条件代码块的结束。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>单分支：
    <span class="k">if </span>CONDITION<span class="p">;</span> <span class="k">then
        if</span><span class="nt">-true</span>
    <span class="k">fi

</span>双分支：
    <span class="k">if </span>CONDITION<span class="p">;</span> <span class="k">then
        if</span><span class="nt">-true</span>
    <span class="k">else
        if</span><span class="nt">-false</span>
    <span class="k">fi

</span>多分支：
    <span class="k">if </span>CONDITION1<span class="p">;</span> <span class="k">then
        if</span><span class="nt">-true</span>
    <span class="k">elif </span>CONDITION2<span class="p">;</span> <span class="k">then
        if</span><span class="nt">-ture</span>
    <span class="k">elif </span>CONDITION3<span class="p">;</span> <span class="k">then
        if</span><span class="nt">-ture</span>
    ...
    esle
        all-false
    <span class="k">fi</span>
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#判断某路径下所有文件的类型</span>
<span class="c">#!/bin/bash</span>
<span class="c">#</span>

<span class="k">for </span>file <span class="k">in</span> <span class="si">$(</span><span class="nb">ls</span> /var<span class="si">)</span><span class="p">;</span> <span class="k">do
    if</span> <span class="o">[</span> <span class="nt">-f</span> /var/<span class="nv">$file</span> <span class="o">]</span><span class="p">;</span> <span class="k">then
    </span><span class="nb">echo</span> <span class="s2">"Common file."</span>
    <span class="k">elif</span> <span class="o">[</span> <span class="nt">-L</span> /var/<span class="nv">$file</span> <span class="o">]</span><span class="p">;</span> <span class="k">then
    </span><span class="nb">echo</span> <span class="s2">"Symbolic file."</span>
    <span class="k">elif</span> <span class="o">[</span> <span class="nt">-d</span> /var/<span class="nv">$file</span> <span class="o">]</span><span class="p">;</span> <span class="k">then
    </span><span class="nb">echo</span> <span class="s2">"Directory."</span>
    <span class="k">else
    </span><span class="nb">echo</span> <span class="s2">"Other type."</span>
    <span class="k">fi
done</span>
</code></pre></div></div>

<h2 id="case"><code class="language-plaintext highlighter-rouge">case</code></h2>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">case</span> 变量引用 <span class="k">in
</span>PAT1<span class="p">)</span>
    分支1
    <span class="p">;;</span>
PAT2<span class="p">)</span>
    分支2
    <span class="p">;;</span>
...
<span class="k">*</span><span class="p">)</span>
    默认分支
    <span class="p">;;</span>
<span class="k">esac</span>
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/bash</span>
<span class="c">#</span>
<span class="c"># chkconfig: - 88 12</span>
<span class="c"># description: test service script</span>
<span class="c">#</span>
<span class="nv">prog</span><span class="o">=</span><span class="si">$(</span><span class="nb">basename</span> <span class="nv">$0</span><span class="si">)</span>
<span class="nv">lockfile</span><span class="o">=</span>/var/lock/subsys/<span class="nv">$prog</span>

start<span class="o">()</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">[</span> <span class="nt">-e</span> <span class="nv">$lockfile</span> <span class="o">]</span><span class="p">;</span> <span class="k">then
    </span><span class="nb">echo</span> <span class="s2">"</span><span class="nv">$prog</span><span class="s2"> is aleady running."</span>
    <span class="k">return </span>0
    <span class="k">else
    </span><span class="nb">touch</span> <span class="nv">$lockfile</span>
    <span class="o">[</span> <span class="nv">$?</span> <span class="nt">-eq</span> 0 <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s2">"Starting </span><span class="nv">$prog</span><span class="s2"> finished."</span>
    <span class="k">fi</span>
<span class="o">}</span>

stop<span class="o">()</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">[</span> <span class="nt">-e</span> <span class="nv">$lockfile</span> <span class="o">]</span><span class="p">;</span> <span class="k">then
    </span><span class="nb">rm</span> <span class="nt">-f</span> <span class="nv">$lockfile</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s2">"Stop </span><span class="nv">$prog</span><span class="s2"> ok."</span>
    <span class="k">else
    </span><span class="nb">echo</span> <span class="s2">"</span><span class="nv">$prog</span><span class="s2"> is stopped yet."</span>
    <span class="k">fi</span>
<span class="o">}</span>

status<span class="o">()</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">[</span> <span class="nt">-e</span> <span class="nv">$lockfile</span> <span class="o">]</span><span class="p">;</span> <span class="k">then
    </span><span class="nb">echo</span> <span class="s2">"</span><span class="nv">$prog</span><span class="s2"> is running."</span>
    <span class="k">else
    </span><span class="nb">echo</span> <span class="s2">"</span><span class="nv">$prog</span><span class="s2"> is stopped."</span>
    <span class="k">fi</span>
<span class="o">}</span>

usage<span class="o">()</span> <span class="o">{</span>
    <span class="nb">echo</span> <span class="s2">"Usage: </span><span class="nv">$prog</span><span class="s2"> {start|stop|restart|status}"</span>
<span class="o">}</span>

<span class="k">if</span> <span class="o">[</span> <span class="nv">$# </span><span class="nt">-lt</span> 1 <span class="o">]</span><span class="p">;</span> <span class="k">then
    </span>usage
    <span class="nb">exit </span>1
<span class="k">fi

case</span> <span class="nv">$1</span> <span class="k">in
</span>start<span class="p">)</span>
    start
    <span class="p">;;</span>
stop<span class="p">)</span>
    stop
    <span class="p">;;</span>
restart<span class="p">)</span>
    stop
    start
    <span class="p">;;</span>
status<span class="p">)</span>
    status
    <span class="p">;;</span>
<span class="k">*</span><span class="p">)</span>
    usage
<span class="k">esac</span>
</code></pre></div></div>
<h1 id="循环">循环</h1>

<h2 id="for-loop"><code class="language-plaintext highlighter-rouge">for</code> loop</h2>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for </span>NAME <span class="k">in </span>LIST<span class="p">;</span> <span class="k">do
    </span>循环体
<span class="k">done</span>
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#打印九九乘法表；(分别使用for和while循环实现)</span>
<span class="c">#!/bin/bash</span>
<span class="c">#</span>

<span class="k">for </span>j <span class="k">in</span> <span class="o">{</span>1..9<span class="o">}</span><span class="p">;</span> <span class="k">do
    for </span>i <span class="k">in</span> <span class="si">$(</span><span class="nb">seq </span>1 <span class="nv">$j</span><span class="si">)</span><span class="p">;</span> <span class="k">do
        </span><span class="nb">echo</span> <span class="nt">-e</span> <span class="nt">-n</span> <span class="s2">"</span><span class="k">${</span><span class="nv">i</span><span class="k">}</span><span class="s2">X</span><span class="k">${</span><span class="nv">j</span><span class="k">}</span><span class="s2">=</span><span class="nv">$[$i</span><span class="s2">*</span><span class="nv">$j</span><span class="s2">]</span><span class="se">\t</span><span class="s2">"</span>
    <span class="k">done
    </span><span class="nb">echo
</span><span class="k">done</span>
</code></pre></div></div>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/bash</span>
<span class="c">#</span>
<span class="nb">declare</span> <span class="nt">-i</span> <span class="nv">i</span><span class="o">=</span>1
<span class="nb">declare</span> <span class="nt">-i</span> <span class="nv">j</span><span class="o">=</span>1

<span class="k">while</span> <span class="o">[</span> <span class="nv">$j</span> <span class="nt">-le</span> 9 <span class="o">]</span><span class="p">;</span> <span class="k">do
    while</span> <span class="o">[</span> <span class="nv">$i</span> <span class="nt">-le</span> <span class="nv">$j</span> <span class="o">]</span><span class="p">;</span> <span class="k">do
        </span><span class="nb">echo</span> <span class="nt">-e</span> <span class="nt">-n</span> <span class="s2">"</span><span class="k">${</span><span class="nv">i</span><span class="k">}</span><span class="s2">X</span><span class="k">${</span><span class="nv">j</span><span class="k">}</span><span class="s2">=</span><span class="nv">$[$i</span><span class="s2">*</span><span class="nv">$j</span><span class="s2">]</span><span class="se">\t</span><span class="s2">"</span>
        <span class="nb">let </span>i++
    <span class="k">done

    </span><span class="nb">echo
    let </span><span class="nv">i</span><span class="o">=</span>1
    <span class="nb">let </span>j++
<span class="k">done</span>
</code></pre></div></div>
<h2 id="while-loop"><code class="language-plaintext highlighter-rouge">while</code> loop</h2>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">while </span>CONDITION<span class="p">;</span> <span class="k">do
    </span>循环体
<span class="k">done</span>
</code></pre></div></div>
<p>案例</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#利用RANDOM生成10个随机数字，输出这个10数字，并显示其中的最大者和最小者；</span>
<span class="c">#!/bin/bash</span>
<span class="c">#</span>
<span class="nb">declare</span> <span class="nt">-i</span> <span class="nv">max</span><span class="o">=</span>0
<span class="nb">declare</span> <span class="nt">-i</span> <span class="nv">min</span><span class="o">=</span>0
<span class="nb">declare</span> <span class="nt">-i</span> <span class="nv">i</span><span class="o">=</span>1


<span class="k">while</span> <span class="o">[</span> <span class="nv">$i</span> <span class="nt">-le</span> 9 <span class="o">]</span><span class="p">;</span> <span class="k">do
    </span><span class="nv">rand</span><span class="o">=</span><span class="nv">$RANDOM</span>
    <span class="nb">echo</span> <span class="nv">$rand</span>

    <span class="k">if</span> <span class="o">[</span> <span class="nv">$i</span> <span class="nt">-eq</span> 1 <span class="o">]</span><span class="p">;</span> <span class="k">then
        </span><span class="nv">max</span><span class="o">=</span><span class="nv">$rand</span>
        <span class="nv">min</span><span class="o">=</span><span class="nv">$rand</span>
    <span class="k">fi

    if</span> <span class="o">[</span> <span class="nv">$rand</span> <span class="nt">-gt</span> <span class="nv">$max</span> <span class="o">]</span><span class="p">;</span> <span class="k">then
        </span><span class="nv">max</span><span class="o">=</span><span class="nv">$rand</span>
    <span class="k">fi
    if</span> <span class="o">[</span> <span class="nv">$rand</span> <span class="nt">-lt</span> <span class="nv">$min</span> <span class="o">]</span><span class="p">;</span> <span class="k">then
        </span><span class="nv">min</span><span class="o">=</span><span class="nv">$rand</span>
    <span class="k">fi
    </span><span class="nb">let </span>i++
<span class="k">done

</span><span class="nb">echo</span> <span class="s2">"MAX: </span><span class="nv">$max</span><span class="s2">."</span>
<span class="nb">echo</span> <span class="s2">"MIN: </span><span class="nv">$min</span><span class="s2">."</span>
</code></pre></div></div>

<h2 id="until"><code class="language-plaintext highlighter-rouge">until</code></h2>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">until </span>CONDITION<span class="p">;</span> <span class="k">do
    </span>循环体
<span class="k">done</span>
</code></pre></div></div>

<h2 id="循环控制">循环控制</h2>

<p>我们会遇到想提前结束一个循环或跳过某次循环执行的情况。这些可以使用shell内建的<code class="language-plaintext highlighter-rouge">break</code>和<code class="language-plaintext highlighter-rouge">continue</code>语句来实现。它们可以在任何循环中使用。</p>

<p><code class="language-plaintext highlighter-rouge">break</code>语句用来提前结束当前循环。我们之前已经见过它了。</p>

<p><code class="language-plaintext highlighter-rouge">continue</code>语句用来跳过某次迭代。我们可以这么来用它：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">continue</span> <span class="o">[</span>N]：提前结束第N层的本轮循环，而直接进入下一轮判断；
    <span class="k">while </span>CONDTIITON1<span class="p">;</span> <span class="k">do
        </span>CMD1
        ...
        <span class="k">if </span>CONDITION2<span class="p">;</span> <span class="k">then
            continue
        fi
        </span>CMDn
        ...
    <span class="k">done

</span><span class="nb">break</span> <span class="o">[</span>N]：提前结束循环；
    <span class="k">while </span>CONDTIITON1<span class="p">;</span> <span class="k">do
        </span>CMD1
        ...
        <span class="k">if </span>CONDITION2<span class="p">;</span> <span class="k">then
            </span><span class="nb">break
        </span><span class="k">fi
        </span>CMDn
        ...
    <span class="k">done</span>
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="o">((</span> i <span class="o">=</span> 0<span class="p">;</span> i &lt; 10<span class="p">;</span> i++ <span class="o">))</span><span class="p">;</span> <span class="k">do
  if</span> <span class="o">[[</span> <span class="k">$((</span> i <span class="o">%</span> <span class="m">2</span> <span class="k">))</span> <span class="nt">-eq</span> 0 <span class="o">]]</span><span class="p">;</span> <span class="k">then continue</span><span class="p">;</span> <span class="k">fi
  </span><span class="nb">echo</span> <span class="nv">$i</span>
<span class="k">done</span>
</code></pre></div></div>

<p>运行上面的例子，会打印出所有0到9之间的奇数。</p>
<h1 id="数组">数组</h1>

<p><strong>${ARRAY_NAME[INDEX]}</strong></p>

<p>声明数组：</p>
<ul>
  <li>declare -a ARRAY_NAME</li>
  <li>declare -A ARRAY_NAME: 关联数组</li>
</ul>

<p>数组元素的赋值:(元素之间空格分开)</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1. 一次只赋值一个元素；
    ARRAY_NAME[INDEX]=VALUE
        weekdays[0]="Sunday"
        weekdays[4]="Thursday"
2. 一次赋值全部元素：
    ARRAY_NAME=("VAL1" "VAL2" "VAL3" ...)
3. 只赋值特定元素：
    ARRAY_NAME=([0]="VAL1" [3]="VAL2" ...)
4. read -a ARRAY
</code></pre></div></div>

<p>引用数组元素：${ARRAY_NAME[INDEX]}<br />
        注意：省略[INDEX]表示引用下标为0的元素；</p>

<p><em>数组的添加删除</em></p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#add element to the begining of an array use</span>
<span class="nv">arr</span><span class="o">=(</span><span class="s2">"new_element"</span> <span class="s2">"</span><span class="k">${</span><span class="nv">arr</span><span class="p">[@]</span><span class="k">}</span><span class="s2">"</span><span class="o">)</span>
<span class="nv">arr</span><span class="o">=(</span><span class="s2">"new_element1"</span> <span class="s2">"new_element2"</span> <span class="s2">"..."</span> <span class="s2">"new_elementN"</span> <span class="s2">"</span><span class="k">${</span><span class="nv">arr</span><span class="p">[@]</span><span class="k">}</span><span class="s2">"</span><span class="o">)</span>
<span class="c"># add an element to the end of an array use.</span>
<span class="nv">arr</span><span class="o">=(</span> <span class="s2">"</span><span class="k">${</span><span class="nv">arr</span><span class="p">[@]</span><span class="k">}</span><span class="s2">"</span> <span class="s2">"new_element"</span> <span class="o">)</span>
or 
arr+<span class="o">=(</span> <span class="s2">"new_element"</span> <span class="o">)</span>

<span class="nv">arr</span><span class="o">=(</span> <span class="s2">"</span><span class="k">${</span><span class="nv">arr</span><span class="p">[@]</span><span class="k">}</span><span class="s2">"</span> <span class="s2">"new_element1"</span> <span class="s2">"new_element2"</span> <span class="s2">"..."</span> <span class="s2">"new_elementN"</span><span class="o">)</span> <span class="c">#Or</span>
arr+<span class="o">=(</span> <span class="s2">"new_element1"</span> <span class="s2">"new_element2"</span> <span class="s2">"..."</span> <span class="s2">"new_elementN"</span> <span class="o">)</span>

<span class="c"># add an element to the specific index of an array use</span>
<span class="c"># unset array_name[index]</span>
<span class="nv">arr</span><span class="o">=(</span>23 56 99 <span class="o">)</span>
<span class="nb">unset </span>arr[1]
<span class="nb">echo</span> <span class="k">${</span><span class="nv">arr</span><span class="p">[@]</span><span class="k">}</span>
<span class="nb">unset </span>arr
<span class="nb">echo</span> <span class="k">${</span><span class="nv">arr</span><span class="p">[*]</span><span class="k">}</span> <span class="c">#没有结果因为整个组都被删除了</span>

</code></pre></div></div>

<p>数组的长度(数组中元素的个数)：${#ARRAY_NAME[*]}, ${#ARRAY_NAME[@]}</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>root@corp-centos-101 ~]# <span class="nv">color</span><span class="o">=(</span>red green blue<span class="o">)</span>
<span class="o">[</span>root@corp-centos-101 ~]# <span class="nb">echo</span> <span class="k">${</span><span class="nv">color</span><span class="p">[0]</span><span class="k">}</span>
red
<span class="o">[</span>root@corp-centos-101 ~]# <span class="nb">echo</span> <span class="k">${</span><span class="nv">color</span><span class="p">[1]</span><span class="k">}</span>
green
<span class="o">[</span>root@corp-centos-101 ~]# <span class="nb">echo</span> <span class="k">${</span><span class="nv">color</span><span class="p">[2]</span><span class="k">}</span>
blue
<span class="o">[</span>root@corp-centos-101 ~]# <span class="nv">color2</span><span class="o">=(</span>red green <span class="o">[</span>6]<span class="o">=</span>blue<span class="o">)</span>
<span class="o">[</span>root@corp-centos-101 ~]# <span class="nb">echo</span> <span class="k">${</span><span class="nv">color2</span><span class="p">[0]</span><span class="k">}</span>
red
<span class="o">[</span>root@corp-centos-101 ~]# <span class="nb">echo</span> <span class="k">${</span><span class="nv">color2</span><span class="p">[1]</span><span class="k">}</span>
green
<span class="o">[</span>root@corp-centos-101 ~]# <span class="nb">echo</span> <span class="k">${</span><span class="nv">color2</span><span class="p">[2]</span><span class="k">}</span>

<span class="o">[</span>root@corp-centos-101 ~]# <span class="nb">echo</span> <span class="k">${</span><span class="nv">color2</span><span class="p">[6]</span><span class="k">}</span>
blue
<span class="o">[</span>root@corp-centos-101 ~]# <span class="nb">echo</span> <span class="k">${</span><span class="nv">color2</span><span class="p">[*]</span><span class="k">}</span>
red green blue
<span class="o">[</span>root@corp-centos-101 ~]# <span class="nb">echo</span> <span class="k">${#</span><span class="nv">color2</span><span class="p">[*]</span><span class="k">}</span>
3
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#生成10个随机数保存于数组中，并找出其最大值和最小值；</span>
<span class="c">#!/bin/bash</span>
<span class="c">#</span>
<span class="nb">declare</span> <span class="nt">-a</span> rand
<span class="nb">declare</span> <span class="nt">-i</span> <span class="nv">max</span><span class="o">=</span>0

<span class="k">for </span>i <span class="k">in</span> <span class="o">{</span>0..9<span class="o">}</span><span class="p">;</span> <span class="k">do
    </span>rand[<span class="nv">$i</span><span class="o">]=</span><span class="nv">$RANDOM</span>
    <span class="nb">echo</span> <span class="k">${</span><span class="nv">rand</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span><span class="k">}</span>
    <span class="o">[</span> <span class="k">${</span><span class="nv">rand</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span><span class="k">}</span> <span class="nt">-gt</span> <span class="nv">$max</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="nv">max</span><span class="o">=</span><span class="k">${</span><span class="nv">rand</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span><span class="k">}</span>
<span class="k">done

</span><span class="nb">echo</span> <span class="s2">"Max: </span><span class="nv">$max</span><span class="s2">"</span>
</code></pre></div></div>
<h1 id="函数">函数</h1>

<p>函数的作用</p>
<ul>
  <li>代码重用</li>
  <li>模块化编程</li>
  <li>结构化编程
```bash
语法一：
  function f_name {
      …函数体…
  }</li>
</ul>

<p>语法二：
    f_name() {
        …函数体…
    }</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>函数返回值：
    函数的执行结果返回值：
        (1) 使用echo或print命令进行输出；
        (2) 函数体中调用命令的执行结果；
    函数的退出状态码：
        (1) 默认取决于函数体中执行的最后一条命令的退出状态码；
        (2) 自定义退出状态码：
            return
先声明变量            
函数可以接收参数并返回结果 —— 返回值。参数，在函数内部，跟[非交互式](#非交互模式)下的脚本参数处理方式相同 —— 使用[位置参数](#位置参数)。返回值可以使用`return`命令 _返回_ 。

下面这个函数接收一个名字参数，返回`0`，表示成功执行。
```bash
# 带参数的函数
greeting () {
  if [[ -n $1 ]]; then
    echo "Hello, $1!"
  else
    echo "Hello, unknown!"
  fi
  return 0
}

greeting Denys  # Hello, Denys!
greeting        # Hello, unknown!
</code></pre></div></div>

<h1 id="shell-扩展">shell 扩展</h1>
<h2 id="bash-下的-split-取数组的首尾">bash 下的 split 取“数组”的首、尾：</h2>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">file</span><span class="o">=</span>/dir1/dir2/dir3/my.file.txt
</code></pre></div></div>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">${</span><span class="nv">file</span><span class="p">#*/</span><span class="k">}</span>：拿掉第一条 / 及其左边的字符串：dir1/dir2/dir3/my.file.txt
<span class="k">${</span><span class="nv">file</span><span class="p">##*/</span><span class="k">}</span>：拿掉最后一条 / 及其左边的字符串：my.file.txt
<span class="k">${</span><span class="nv">file</span><span class="p">#*.</span><span class="k">}</span>：拿掉第一个 <span class="nb">.</span>  及其左边的字符串：file.txt
<span class="k">${</span><span class="nv">file</span><span class="p">##*.</span><span class="k">}</span>：拿掉最后一个 <span class="nb">.</span>  及其左边的字符串：txt
<span class="k">${</span><span class="nv">file</span><span class="p">%/*</span><span class="k">}</span>：拿掉最后条 / 及其右边的字符串：/dir1/dir2/dir3
<span class="k">${</span><span class="nv">file</span><span class="p">%%/*</span><span class="k">}</span>：拿掉第一条 / 及其右边的字符串：<span class="o">(</span>空值<span class="o">)</span>
<span class="k">${</span><span class="nv">file</span><span class="p">%.*</span><span class="k">}</span>：拿掉最后一个 <span class="nb">.</span>  及其右边的字符串：/dir1/dir2/dir3/my.file
<span class="k">${</span><span class="nv">file</span><span class="p">%%.*</span><span class="k">}</span>：拿掉第一个 <span class="nb">.</span>  及其右边的字符串：/dir1/dir2/dir3/my
</code></pre></div></div>

<p>Tips：</p>

<p>记忆的方法为：<br />
# 是去掉左边(在键盘上 # 在 $ 之左边)<br />
% 是去掉右边(在键盘上 % 在 $ 之右边)<br />
单一符号是最小匹配﹔两个符号是最大匹配（类似贪婪匹配）。</p>

<h2 id="bash-下的-replace-与-replaceall">bash 下的 replace 与 replaceAll</h2>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">${</span><span class="nv">file</span><span class="p">/dir/path</span><span class="k">}</span>：将第一个 <span class="nb">dir </span>提换为 path：/path1/dir2/dir3/my.file.txt
<span class="k">${</span><span class="nv">file</span><span class="p">//dir/path</span><span class="k">}</span>：将全部 <span class="nb">dir </span>提换为 path：/path1/path2/path3/my.file.tx
</code></pre></div></div>
<h2 id="bash-下的变量空值检测与初始化">bash 下的变量空值检测与初始化</h2>
<p>利用 ${ } 还可针对不同的变量状态赋值(没设定、空值、非空值)：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">${</span><span class="nv">file</span><span class="p">-my.file.txt</span><span class="k">}</span> ：假如 <span class="nv">$file</span> 没有设定，则使用 my.file.txt 作传回值。<span class="o">(</span>空值及非空值时不作处理<span class="o">)</span>
<span class="k">${</span><span class="nv">file</span><span class="k">:-</span><span class="nv">my</span><span class="p">.file.txt</span><span class="k">}</span> ：假如 <span class="nv">$file</span> 没有设定或为空值，则使用 my.file.txt 作传回值。 <span class="o">(</span>非空值时不作处理<span class="o">)</span>
<span class="k">${</span><span class="nv">file</span><span class="p">+my.file.txt</span><span class="k">}</span> ：假如 <span class="nv">$file</span> 设为空值或非空值，均使用 my.file.txt 作传回值。<span class="o">(</span>没设定时不作处理<span class="o">)</span>
<span class="k">${</span><span class="nv">file</span>:+my.file.txt<span class="k">}</span> ：若 <span class="nv">$file</span> 为非空值，则使用 my.file.txt 作传回值。 <span class="o">(</span>没设定及空值时不作处理<span class="o">)</span>
<span class="k">${</span><span class="nv">file</span><span class="p">=my.file.txt</span><span class="k">}</span> ：若 <span class="nv">$file</span> 没设定，则使用 my.file.txt 作传回值，同时将 <span class="nv">$file</span> 赋值为 my.file.txt 。 <span class="o">(</span>空值及非空值时不作处理<span class="o">)</span>
<span class="k">${</span><span class="nv">file</span>:<span class="p">=my.file.txt</span><span class="k">}</span> ：若 <span class="nv">$file</span> 没设定或为空值，则使用 my.file.txt 作传回值，同时将 <span class="nv">$file</span> 赋值为 my.file.txt 。 <span class="o">(</span>非空值时不作处理<span class="o">)</span>
<span class="k">${</span><span class="nv">file</span><span class="p">?my.file.txt</span><span class="k">}</span> ：若 <span class="nv">$file</span> 没设定，则将 my.file.txt 输出至 STDERR。 <span class="o">(</span>空值及非空值时不作处理<span class="o">)</span>
<span class="k">${</span><span class="nv">file</span>:?my.file.txt<span class="k">}</span> ：若 <span class="nv">$file</span> 没设定或为空值，则将 my.file.txt 输出至 STDERR。 <span class="o">(</span>非空值时不作处理<span class="o">)</span>
</code></pre></div></div>
<p>Tips:
以上的理解在于, 你一定要分清楚 unset 与 null 及 non-null 这三种赋值状态.<br />
一般而言, : 与 null 有关, 若不带 : 的话, null 不受影响, 若带 : 则连 null 也受影响。<br />
而 - 和 = 的区别在于是否把传回值赋给引用变量，例如：</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">${</span><span class="nv">parameter</span><span class="k">:-</span><span class="nv">word</span><span class="k">}</span>     word is only substituted.
<span class="k">${</span><span class="nv">parameter</span>:<span class="p">=word</span><span class="k">}</span>     word is substituted and assigned to parameter.
root@localhost ~ <span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"</span><span class="nv">$var</span><span class="s2">"</span>


root@localhost ~ <span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"</span><span class="k">${</span><span class="nv">var</span><span class="k">:-</span><span class="nv">hello</span><span class="k">}</span><span class="s2">"</span>
hello
root@localhost ~ <span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"</span><span class="nv">$var</span><span class="s2">"</span>


root@localhost ~ <span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"</span><span class="k">${</span><span class="nv">var</span>:<span class="p">=hello</span><span class="k">}</span><span class="s2">"</span>
hello
root@localhost ~ <span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"</span><span class="nv">$var</span><span class="s2">"</span>
</code></pre></div></div>
<h2 id="bash-下的大小写变换">bash 下的大小写变换</h2>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">HI</span><span class="o">=</span>HellO

<span class="nb">echo</span> <span class="s2">"</span><span class="nv">$HI</span><span class="s2">"</span> <span class="c"># HellO</span>
<span class="nb">echo</span> <span class="k">${</span><span class="nv">HI</span><span class="p">^</span><span class="k">}</span> <span class="c"># HellO</span>
<span class="nb">echo</span> <span class="k">${</span><span class="nv">HI</span><span class="p">^^</span><span class="k">}</span> <span class="c"># HELLO</span>
<span class="nb">echo</span> <span class="k">${</span><span class="nv">HI</span><span class="p">,</span><span class="k">}</span> <span class="c"># hellO</span>
<span class="nb">echo</span> <span class="k">${</span><span class="nv">HI</span><span class="p">,,</span><span class="k">}</span> <span class="c"># hello</span>
<span class="nb">echo</span> <span class="k">${</span><span class="nv">HI</span><span class="p">~</span><span class="k">}</span> <span class="c"># hellO</span>
<span class="nb">echo</span> <span class="k">${</span><span class="nv">HI</span><span class="p">~~</span><span class="k">}</span> <span class="c">#hELLo</span>
^大写，,小写， ~大小写切换
重复一次只修改首字母，重复两次则应用于所有字母。

混着用会怎样？
<span class="nb">echo</span> <span class="k">${</span><span class="nv">HI</span><span class="p">^,^</span><span class="k">}</span> <span class="c"># HellO</span>
看来是不行的×_×
</code></pre></div></div>
<h1 id="reference">Reference</h1>

<p>https://mywiki.wooledge.org/BashGuide</p>

    </div>
</div>
<hr>

<!-- valine 评论插件 -->
<h3>评论：</h3>
<div class="comments"></div>
<hr>
<script src='//unpkg.com/valine/dist/Valine.min.js'></script>
<script>
    new Valine({
        el: '.comments',
        appId: '',
        appKey: '',
        avatar: 'robohash',
        placeholder: '留下你的评论吧（支持Markdown）~',
        // visitor: true,
    })
</script>


    </div>
</div>

</main>

<footer class="page-footer teal">
    <div class="container">
        <div class="row">
            <div class="col s12">
                <p class="footer-message grey-text text-lighten-3">学而不厌，诲人不倦</p>
                <hr>
                <p class="visit-statistics">
                    <span id="busuanzi_container_site_pv">访问量：<span id="busuanzi_value_site_pv"></span>次</span>&nbsp;
                    <span id="busuanzi_container_site_pv">访客量：<span id="busuanzi_value_site_uv"></span>人次</span>
                </p>
                <p class="grey-text text-lighten-4">基于 jekyll 的 Github Pages 个人博客网站，技术的学习、总结、分享与提升
</p>
            </div>
        </div>
    </div>
    <div class="footer-copyright">
        <div class="container">
            Copyright &#xA9; 2021 TOSKA'S BLOG. All rights reserved. Powered by
            <a href=https://github.com/toskachin/toskachin.github.io>toskachin</a>.
        </div>
    </div>
    <!-- Search box -->
    <div class="search">
        <i class="material-icons search-icon search-start">search</i>
        <input type="text" class="search-input" placeholder="Searching...（支持正则表达式）" />
        <i class="material-icons search-icon search-clear">clear</i>
        <div class="search-results z-depth-4"></div>
    </div>
    <!-- 右下角功能按钮 -->
    <div class="fixed-action-btn">
        <a class="btn-floating btn-large blue z-depth-4">
            <i class="large material-icons">apps</i>
        </a>
        <ul>
            <li class="category-btn hide">
                <!-- 文章目录按钮 -->
                <a class="sidenav-trigger btn-floating blue lighten-2" data-target="category">
                    <i class="material-icons">format_list_bulleted</i>
                </a>
            </li>
            <li>
                <a class="btn-floating blue lighten-2" href="javascript: searchInput.focus()">
                    <i class="material-icons">search</i>
                </a>
            </li>
            <li>
                <a class="btn-floating blue lighten-2" href="javascript: scrollTo(0, 0);">
                    <i class="material-icons">publish</i>
                </a>
            </li>
            <li>
                <a class="btn-floating blue lighten-2" href="javascript: scrollTo(0, document.body.clientHeight);">
                    <i class="material-icons">file_download</i>
                </a>
            </li>
        </ul>
    </div>
    <!-- 文章目录侧栏 -->
    <ul id="category" class="hide sidenav no-autoinit grey lighten-4 grey-text text-darken-3">
        <li>
            <p class="center-align">目录</p>
        </li>
    </ul>
</footer>


    
    <script src="/assets/js/min/materialize.min.js"></script>
    

    
    <script src="/assets/js/min/post.min.js"></script>
    

    
    <script src="/assets/js/min/particles.min.js"></script>
    

    
    <script src="/assets/js/min/main.min.js"></script>
    

    
    <script src="/assets/js/min/search.min.js"></script>
    

    
    <script src="/assets/js/min/gen-category.min.js"></script>
    




<!-- 以下为插入的第三方网站分析代码 -->

</body>

</html>