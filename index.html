<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css" integrity="sha256-2H3fkXt6FEmrReK448mDVGKb3WW2ZZw35gI7vqHOE4Y=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"toskachin.github.io","root":"/","images":"/images","scheme":"Muse","version":"8.7.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":true,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>
<meta name="description" content="10+ IT career and personal memories">
<meta property="og:type" content="website">
<meta property="og:title" content="RJ&#39;s Blog">
<meta property="og:url" content="https://toskachin.github.io/index.html">
<meta property="og:site_name" content="RJ&#39;s Blog">
<meta property="og:description" content="10+ IT career and personal memories">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="TOSKA">
<meta property="article:tag" content="Tech, Life, 技术，人生">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://toskachin.github.io/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>RJ's Blog</title>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="RJ's Blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">RJ's Blog</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li>
        <li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-overview">
            <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="TOSKA"
      src="/images/avatar.gif">
  <p class="site-author-name" itemprop="name">TOSKA</p>
  <div class="site-description" itemprop="description">10+ IT career and personal memories</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">27</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">29</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/toskachin" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;toskachin" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:royjin@msn.com" title="E-Mail → mailto:royjin@msn.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>


<!-- recent posts -->
    <div class="links-of-blogroll motion-element links-of-blogroll-block">
        <div class="links-of-blogroll-title recent-posts-title">
	    <i class="fa fa-history " aria-hidden="true"></i>
            近期文章
	</div>
	<ul class="links-of-blogroll-list recent-posts-list">
	        <li class="my-links-of-blogroll-item">
		    <a href="/2024/01/20/20240120_change_memo/" title="阶段性总结" target="">
		    阶段性总结
		    </a>
		</li>
	        <li class="my-links-of-blogroll-item">
		    <a href="/2023/10/23/20231023_Ansible_questions/" title="Ansible Questions" target="">
		    Ansible Questions
		    </a>
		</li>
	        <li class="my-links-of-blogroll-item">
		    <a href="/2023/09/15/20230915_devops_tools/" title="Devops 三大运维工具Ansible Terraform Puppet" target="">
		    Devops 三大运维工具Ansible Terraform Puppet
		    </a>
		</li>
	        <li class="my-links-of-blogroll-item">
		    <a href="/2023/09/12/20230912_Interview_questions/" title="Devops/System admin面试常见问题" target="">
		    Devops/System admin面试常见问题
		    </a>
		</li>
	        <li class="my-links-of-blogroll-item">
		    <a href="/2023/09/04/20230904_kubectl_commands/" title="Kubectl 常用命令" target="">
		    Kubectl 常用命令
		    </a>
		</li>
	</ul>
    </div>
          </div>
        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>



    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/toskachin" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://toskachin.github.io/2024/01/20/20240120_change_memo/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="TOSKA">
      <meta itemprop="description" content="10+ IT career and personal memories">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RJ's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/01/20/20240120_change_memo/" class="post-title-link" itemprop="url">阶段性总结</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2024-01-20 00:00:00 / 修改时间：18:02:59" itemprop="dateCreated datePublished" datetime="2024-01-20T00:00:00+08:00">2024-01-20</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/memo/" itemprop="url" rel="index"><span itemprop="name">memo</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>0</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>1 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://toskachin.github.io/2023/10/23/20231023_Ansible_questions/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="TOSKA">
      <meta itemprop="description" content="10+ IT career and personal memories">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RJ's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2023/10/23/20231023_Ansible_questions/" class="post-title-link" itemprop="url">Ansible Questions</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2023-10-23 00:00:00 / 修改时间：19:25:31" itemprop="dateCreated datePublished" datetime="2023-10-23T00:00:00+08:00">2023-10-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/devops/" itemprop="url" rel="index"><span itemprop="name">devops</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>2.1k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>3 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="Ansible"><a href="#Ansible" class="headerlink" title="Ansible"></a>Ansible</h3><h2 id="Ansible-Terraform-Puppet主要区别和用途"><a href="#Ansible-Terraform-Puppet主要区别和用途" class="headerlink" title="Ansible Terraform Puppet主要区别和用途"></a>Ansible Terraform Puppet主要区别和用途</h2><ul>
<li>Ansible: 侧重于deployment,软件配置部署</li>
<li>Puppet: 侧重于System management</li>
<li>Terraform: Server Provisioning Tool: 侧重于Cloud, IaC<h2 id="Ansible-知识"><a href="#Ansible-知识" class="headerlink" title="Ansible 知识"></a>Ansible 知识</h2><h3 id="Basic"><a href="#Basic" class="headerlink" title="Basic"></a>Basic</h3></li>
<li>ansible系统由控制主机和被管理主机组成,控制主机不支持windows平台<ul>
<li>核心: ansible</li>
<li>Core Modules: ansible自带的模块</li>
<li>Custom Modules: 核心模块功能不足时,用户可以添加扩展模块</li>
<li>Plugins: 通过插件来实现记录日志,发送邮件或其他功能</li>
<li>Playbooks: 剧本,YAML格式文件，多个任务定义在一个文件中，定义主机需要调用哪些模块来完成的功能</li>
<li>Connectior Plugins: ansible基于连接插件连接到各个主机上,默认是使用ssh</li>
<li>Host Inventory: 记录由Ansible管理的主机信息，包括端口、密码、ip等</li>
</ul>
</li>
</ul>
<h3 id="常用配置参数"><a href="#常用配置参数" class="headerlink" title="常用配置参数"></a>常用配置参数</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">inventory = /etc/ansible/hosts      #这个参数表示资源清单inventory文件的位置</span><br><span class="line">library = /usr/share/ansible        #指向存放Ansible模块的目录，支持多个目录方式，只要用冒号（：）隔开就可以</span><br><span class="line">forks = 5       #并发连接数，默认为5</span><br><span class="line">sudo_user = root        #设置默认执行命令的用户</span><br><span class="line">remote_port = 22        #指定连接被管节点的管理端口，默认为22端口，建议修改，能够更加安全</span><br><span class="line">host_key_checking = False       #设置是否检查SSH主机的密钥，值为True/False。关闭后第一次连接不会提示配置实例</span><br><span class="line">timeout = 60        #设置SSH连接的超时时间，单位为秒</span><br><span class="line">log_path = /var/log/ansible.log     #指定一个存储ansible日志的文件（默认不记录日志）</span><br></pre></td></tr></table></figure>


<h2 id="Ansible-commom-questions"><a href="#Ansible-commom-questions" class="headerlink" title="Ansible commom questions"></a>Ansible commom questions</h2><ul>
<li>Ansible module shell and command difference <ul>
<li>shell call /bin/sh </li>
<li>command can’t reolve variable like $HOME, “&lt;”, “&amp;”</li>
</ul>
</li>
<li>Ansible configure file ansible.cfg load orders <ul>
<li>检查环境变量ANSIBLE_CONFIG指向的路径文件</li>
<li>ansible.cfg (in the current directory)</li>
<li>~/.ansible.cfg</li>
<li>/etc/ansible/ansible.cfg</li>
</ul>
</li>
<li>Ansible facts cache<ul>
<li>gathering = smart</li>
<li>implicit</li>
<li>explicit<br>ansible的配置文件中可以修改’gathering’的值为’smart’、’implicit’或者’explicit’。smart表示默认收集facts，但facts已有的情况下不会收集，即使用缓存facts；implicit表示默认收集facts，要禁止收集，必须使用gather_facts: False；explicit则表示默认不收集，要显式收集，必须使用gather_facts: Ture。</li>
</ul>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[defaults]</span><br><span class="line">gathering = smart</span><br><span class="line">fact_caching_timeout = 86400</span><br><span class="line">fact_caching = jsonfile</span><br><span class="line">fact_caching_connection = /path/to/cachedir</span><br></pre></td></tr></table></figure>

<p>这里设置的缓存过期时间为86400秒，即缓存一天。缓存的json文件放在/path/to/cachedir目录下，各主机的缓存文件以主机名命名。缓存文件是一个json文件，要查看缓存文件，如/path/to/cachedir/192.168.100.59中的内容，使用如下语句即可。</p>
<p><code>cat /path/to/cachedir/192.168.100.59 | python -m json.tool</code></p>
<ul>
<li><p>Ansible playbook <code>serial</code></p>
</li>
<li><p>当host具有太多个时候，serial 可以定义一次跑的服务器的个数或者百分比方式30%来定义跑多少个服务器一次。</p>
</li>
<li><p>Ansible how to run one local script on remote server</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- name: Transfer and execute a script.</span><br><span class="line">  hosts: all</span><br><span class="line">  tasks:</span><br><span class="line">     - name: Copy and Execute the script </span><br><span class="line">       script: /home/user/userScript.sh</span><br></pre></td></tr></table></figure></li>
<li><p>Ansible how to debug one task output</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">- hosts: apt-servers</span><br><span class="line">  tasks:</span><br><span class="line">    - name: Check if reboot is required</span><br><span class="line">      script: /home/ansible/scripts/check.reboot.required.sh</span><br><span class="line">      register: output</span><br><span class="line"></span><br><span class="line">    - debug: var=output.stdout_lines</span><br></pre></td></tr></table></figure></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://toskachin.github.io/2023/09/15/20230915_devops_tools/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="TOSKA">
      <meta itemprop="description" content="10+ IT career and personal memories">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RJ's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2023/09/15/20230915_devops_tools/" class="post-title-link" itemprop="url">Devops 三大运维工具Ansible Terraform Puppet</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2023-09-15 00:00:00" itemprop="dateCreated datePublished" datetime="2023-09-15T00:00:00+08:00">2023-09-15</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2023-09-18 10:54:07" itemprop="dateModified" datetime="2023-09-18T10:54:07+08:00">2023-09-18</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/devops/" itemprop="url" rel="index"><span itemprop="name">devops</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>1k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>2 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="Ansible-Terraform-Puppet主要区别和用途"><a href="#Ansible-Terraform-Puppet主要区别和用途" class="headerlink" title="Ansible Terraform Puppet主要区别和用途"></a>Ansible Terraform Puppet主要区别和用途</h2><ul>
<li>Ansible: 侧重于deployment,软件配置部署</li>
<li>Puppet: 侧重于System management</li>
<li>Terraform: Server Provisioning Tool: 侧重于Cloud, IaC<h2 id="Ansible-知识"><a href="#Ansible-知识" class="headerlink" title="Ansible 知识"></a>Ansible 知识</h2><h3 id="Basic"><a href="#Basic" class="headerlink" title="Basic"></a>Basic</h3></li>
<li>ansible系统由控制主机和被管理主机组成,控制主机不支持windows平台<ul>
<li>核心: ansible</li>
<li>Core Modules: ansible自带的模块</li>
<li>Custom Modules: 核心模块功能不足时,用户可以添加扩展模块</li>
<li>Plugins: 通过插件来实现记录日志,发送邮件或其他功能</li>
<li>Playbooks: 剧本,YAML格式文件，多个任务定义在一个文件中，定义主机需要调用哪些模块来完成的功能</li>
<li>Connectior Plugins: ansible基于连接插件连接到各个主机上,默认是使用ssh</li>
<li>Host Inventory: 记录由Ansible管理的主机信息，包括端口、密码、ip等</li>
</ul>
</li>
</ul>
<h3 id="Ansible配置文件读取顺序"><a href="#Ansible配置文件读取顺序" class="headerlink" title="Ansible配置文件读取顺序"></a>Ansible配置文件读取顺序</h3><ol>
<li>检查环境变量ANSIBLE_CONFIG指向的路径文件</li>
<li>~/.ansible.cfg</li>
<li>/etc/ansible/ansible.cfg<h3 id="常用配置参数"><a href="#常用配置参数" class="headerlink" title="常用配置参数"></a>常用配置参数</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">inventory = /etc/ansible/hosts      #这个参数表示资源清单inventory文件的位置</span><br><span class="line">library = /usr/share/ansible        #指向存放Ansible模块的目录，支持多个目录方式，只要用冒号（：）隔开就可以</span><br><span class="line">forks = 5       #并发连接数，默认为5</span><br><span class="line">sudo_user = root        #设置默认执行命令的用户</span><br><span class="line">remote_port = 22        #指定连接被管节点的管理端口，默认为22端口，建议修改，能够更加安全</span><br><span class="line">host_key_checking = False       #设置是否检查SSH主机的密钥，值为True/False。关闭后第一次连接不会提示配置实例</span><br><span class="line">timeout = 60        #设置SSH连接的超时时间，单位为秒</span><br><span class="line">log_path = /var/log/ansible.log     #指定一个存储ansible日志的文件（默认不记录日志）</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="Terraform-实战案例"><a href="#Terraform-实战案例" class="headerlink" title="Terraform 实战案例"></a>Terraform 实战案例</h2><ul>
<li>The difference of Terraform <code>resource</code> and <code>data</code><ul>
<li><code>data</code> is mostly for ready only resources like AMI</li>
<li><code>recourse</code> is for editable resources like ec2, network policy<h2 id="Puppet-实战案例"><a href="#Puppet-实战案例" class="headerlink" title="Puppet 实战案例"></a>Puppet 实战案例</h2></li>
</ul>
</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://toskachin.github.io/2023/09/12/20230912_Interview_questions/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="TOSKA">
      <meta itemprop="description" content="10+ IT career and personal memories">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RJ's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2023/09/12/20230912_Interview_questions/" class="post-title-link" itemprop="url">Devops/System admin面试常见问题</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2023-09-12 00:00:00" itemprop="dateCreated datePublished" datetime="2023-09-12T00:00:00+08:00">2023-09-12</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2023-09-18 11:14:06" itemprop="dateModified" datetime="2023-09-18T11:14:06+08:00">2023-09-18</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/interview/" itemprop="url" rel="index"><span itemprop="name">interview</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>14k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>24 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="Devops-tools-questions"><a href="#Devops-tools-questions" class="headerlink" title="Devops tools questions"></a>Devops tools questions</h2><h3 id="Ansible"><a href="#Ansible" class="headerlink" title="Ansible"></a>Ansible</h3><ul>
<li>Ansible module shell and command difference <ul>
<li>shell call /bin/sh </li>
<li>command can’t reolve variable like $HOME, “&lt;”, “&amp;”</li>
</ul>
</li>
<li>Ansible configure file ansible.cfg load orders <ul>
<li>检查环境变量ANSIBLE_CONFIG指向的路径文件</li>
<li>ansible.cfg (in the current directory)</li>
<li>~/.ansible.cfg</li>
<li>/etc/ansible/ansible.cfg</li>
</ul>
</li>
<li>Ansible facts cache<ul>
<li>gathering = smart</li>
<li>implicit</li>
<li>explicit<br>ansible的配置文件中可以修改’gathering’的值为’smart’、’implicit’或者’explicit’。smart表示默认收集facts，但facts已有的情况下不会收集，即使用缓存facts；implicit表示默认收集facts，要禁止收集，必须使用gather_facts: False；explicit则表示默认不收集，要显式收集，必须使用gather_facts: Ture。</li>
</ul>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[defaults]</span><br><span class="line">gathering = smart</span><br><span class="line">fact_caching_timeout = 86400</span><br><span class="line">fact_caching = jsonfile</span><br><span class="line">fact_caching_connection = /path/to/cachedir</span><br></pre></td></tr></table></figure>

<p>这里设置的缓存过期时间为86400秒，即缓存一天。缓存的json文件放在/path/to/cachedir目录下，各主机的缓存文件以主机名命名。缓存文件是一个json文件，要查看缓存文件，如/path/to/cachedir/192.168.100.59中的内容，使用如下语句即可。</p>
<p><code>cat /path/to/cachedir/192.168.100.59 | python -m json.tool</code></p>
<ul>
<li>Ansible playbook <code>serial</code></li>
<li>当host具有太多个时候，serial 可以定义一次跑的服务器的个数或者百分比方式30%来定义跑多少个服务器一次。</li>
<li>Ansible how to run one local script on remote server</li>
</ul>
<h2 id="Regular-Questions"><a href="#Regular-Questions" class="headerlink" title="Regular Questions"></a>Regular Questions</h2><ul>
<li>Explain vmstat command details<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">useful information for </span><br><span class="line">- running cpu, block cpu</span><br><span class="line">	- r: The number of processes waiting for run time.</span><br><span class="line">	- b:  The number of processes in uninterruptible sleep.</span><br><span class="line">- memory usage</span><br><span class="line">- swap </span><br><span class="line">- io - input/ouput</span><br><span class="line">	- bi - Blocks received from a block device (blocks/s)</span><br><span class="line">	- bo - Blocks sent to a block device (blocks/s).</span><br><span class="line">- system - </span><br><span class="line">	- in - The number of interrupts per second, including the clock.</span><br><span class="line">	- cs - The number of context switches per second.</span><br><span class="line">- cpu - </span><br><span class="line">	- wa: Time spent waiting for IO</span><br><span class="line">	- sy: Time spent running kernel code. (system time)</span><br><span class="line">	- us: Time spent running non-kernel code. (user time, including nice time)</span><br><span class="line">- -d  show disk reads/wirtes/IO</span><br><span class="line">- -s  show memory swap</span><br></pre></td></tr></table></figure></li>
<li>What are HTTP status codes?</li>
</ul>
<ul>
<li>HTTP status codes are predefined status of the task at the server<ul>
<li>1xx - represents informational responses</li>
<li>2xx - represents succesful responses</li>
<li>3xx - represents redirect responses</li>
<li>4xx - represents client errors</li>
<li>5xx - represents server errors</li>
</ul>
</li>
<li>The most commmons status codes are:<ul>
<li>200 Success/OK</li>
<li>201 - CREATED - used by POST or PUT methods</li>
<li>304 - NOT MODIFIED - used in conditional GET Request to reduce bandwitdth use</li>
<li>400 - BAD REQUEST - This can be due to validation errors or missing input data</li>
<li>404 - NOT FOUND - Resource method is not available</li>
<li>500 - INTERNAL SERVER ERROR - server threw some exceptions while running the method</li>
<li>502 - BAD GATEWAY - Server was not able to get the response from another upstream server</li>
</ul>
</li>
</ul>
<ul>
<li><p>Describe the most common HTTP methods/verbs, and give examples:</p>
<ul>
<li>GET - Read only operation, used to fetch detail from the server, downloads</li>
<li>POST - This method is used for the creationg of new resources on the server</li>
<li>PUT - This method is used to update existing resource on the server or to replace the resource, PUT it’s indepotent, and POST isn’t, with PUT you can update a resource N times, but if you try with post you will create N resources. PUT can create resources.</li>
<li>PATCH - Applies a partial update to a resource and doesn’t create a new resource</li>
<li>DELETE - This method is used to delete the resource on the server</li>
<li>TRACE - Provides a loop back test along the path to the target resource providing a useful debugging mechanism.</li>
<li>OPTIONS - Fetches the list of supported options of resources present on the server.</li>
</ul>
</li>
<li><p>What is RAID? What is RAID0, RAID1, RAID5, RAID10?<br>RAID (Redundant Array of Independent Disks) it’ s a data storage virtualization technology that combines multiple physical disks in one logical volume.</p>
<ul>
<li>RAID0 - Striping, the data is striped between 2 or more disks, improving speed but compromising availability.</li>
<li>RAID1 - Mirroring, the data is mirrored between 2 or more disks, improving availability (the server could lose N - 1 disks) but compromises the speed (replication time).</li>
<li>RAID5 -  Blocks striped but uses distributed parity, RAID5 uses minimum 3 disks, that stripe data between them, but replicates blocks too, it’s a good RAID for databases, in this scenario read operations are good, but write can be slow.</li>
<li>RAID10 - It’s a implementation using RAID0 + RAID1, uses 4 disks, striping data between 2 of then and mirroring this data in another 2 disks.</li>
</ul>
</li>
<li><p>What is a level 0 backup? What is an incremental backup?</p>
<ul>
<li>Level0 backup it’s a full backup (all blocks), an after a level 0 backup, we can initializes an incremental backup rotine ( only the difference between the blocks)</li>
</ul>
</li>
<li><p>Describe the general file system hierarchy of a Linux system.</p>
<ul>
<li>/proc   - process information</li>
<li>/var  -variable data, most notably log files</li>
<li>/usr - user related programs</li>
<li>/home  - home directories</li>
<li>/etc - system configuration files</li>
<li>opt  - optional or three party software</li>
<li>/dev - device files</li>
<li>/bin - Binaries and other executable programs.</li>
<li>/sbin  -similar to /bin with the exception that these ready to run binaries are reserved for root users</li>
<li>/srv  - Srv is a serve folder. It holds site specific data to be served by the system for protocols such as, ftp, rsync, www, cvs etc</li>
<li>/lib - Lib contains system library binaries that are required to run the system</li>
<li>/sys - This is kinda like /proc it is used for plug and play configuration</li>
<li>/root - Root is the “home” directory for root.</li>
<li>/mnt - This directory is provided so that the system administrator may temporarily mount a filesystem as needed</li>
</ul>
</li>
</ul>
<ul>
<li><p>How to redirect STDOUT and STDERR in bash? (&gt; /dev/null 2&gt;&amp;1)</p>
<ul>
<li>1&gt; redirect the STDOUT</li>
<li>1&gt;&gt; redirect the STDOUT in append mode</li>
<li>2&gt; redirect the STDERR</li>
<li>2&gt;&gt; redirect the STDERR in append mode</li>
<li>&amp;&gt; redirect both STDERR and STDOUT</li>
<li>&amp;&gt;&gt; redirect both STDERR and STDOUT in append mode</li>
<li>2&gt;&amp;1 redirect STDERR to STDOUT</li>
</ul>
</li>
<li><p>Explain the three load averages and what do they indicate. What command can be used to view the load averages?</p>
<ul>
<li>The three load averages indicate the processor usage estimated in 1 minute, estimated in 5 minutes and 15 minutes.</li>
<li>top or uptime</li>
</ul>
</li>
<li><p>What does an <code>&amp;</code> after a command do?</p>
<ul>
<li>Makes the command run in a background sub shell, and becomes a job.</li>
</ul>
</li>
<li><p>What does <code>&amp; disown</code> after a command do?</p>
<ul>
<li>disown control jobs that are running in the system, without any paramenter or ID removes the last job on the job table.</li>
</ul>
</li>
<li><p>What is the sticky bit?</p>
<ul>
<li>It’s a permission bit that is set on a file or a directory  that let only the owner of the file/directory or the root user to delete or rename the file.</li>
</ul>
</li>
<li><p>What is the difference between hardlinks and symlinks? What happens when you remove the source to a symlink/hardlink?</p>
<ul>
<li><p>All files in the linux filesystem are a link to a inode, a hard link is a new link to the same inode (if you remove or rename the old or the new link, the file will be intact, but any change in the data on the inode is reflected in all files that refer to that inode), the file system will only delete the inode if you don’t have any link for this inode. Because of this characteristic a hardlink only works on files that are in the same file system.</p>
</li>
<li><p>A softlink, it’s a link that points the link from the inode, so it’s a link from a link if the first link change the name or be deleted, the soft link will break, but can be used between differents filesystems.</p>
</li>
</ul>
</li>
<li><p>What is an inode and what fields are stored in an inode?</p>
<ul>
<li>Each object in the filesystem is represented by a inode that stores all the information about the file, like file type, permissions, owner, group, file size, file access, change and modification time (never birth time), file deletion time, number of links, extended attributes. Each inode has a unique number and it can acessed using <code>stat filename</code> </li>
</ul>
</li>
</ul>
<ul>
<li><p>Describe the mknod command and when you’d use it.</p>
<ul>
<li>mknod command creates a new device in <code>/dev</code> but actually udev creates automatically each device, if something very terrible happen we can recreate some devices using mknod to fix or make some backup.</li>
</ul>
</li>
<li><p>Describe a scenario when you get a “filesystem is full” error, but <code>df</code> shows there is free space.</p>
<ul>
<li>When a filesystem it’s out of inode, it can happen when you have a huge amount of small files, in a small filesystem. <code>df -i</code> will show.</li>
</ul>
</li>
<li><p>Describe a scenario when deleting a file, but ‘df’ not showing the space being freed.</p>
<ul>
<li>when a process it’s still appending that file. We can use <code>lsof</code> to check it.</li>
</ul>
</li>
<li><p>Describe how ‘ps’ works.</p>
<ul>
<li>the ps command read files from /proc and the content of these files are generated by the kernel.</li>
</ul>
</li>
<li><p>What happens to a child process that dies and has no parent process to wait for it and what’s bad about this?</p>
<ul>
<li>creates a zombie process, one zombie process it’s not a big problem, but each process uses a little size of ram, and uses a PID that’s a finite number of it.</li>
</ul>
</li>
<li><p>What are the steps to add a user to a system without using useradd/adduser?</p>
<ul>
<li>Edit <code>/etc/passwd</code> with the new username, configure the home, and shell</li>
<li>Edit <code>/etc/groups</code> add this new username to some groups</li>
<li>Create the user home folder and set the right permissions</li>
<li>Reset the user password with <code>passwd username</code></li>
</ul>
</li>
<li><p>Describe the linux boot process with as much detail as possible, starting from when the system is powered on and ending when you get a prompt.</p>
<ul>
<li>BIOS/UEFI<ul>
<li>BIOS performs startup based in the hardware, POST ( Power On Self Test) processs to initiallize the hardware, after complete, and calls the bootloader.</li>
</ul>
</li>
<li>bootloader<ul>
<li>The bootloader (GRUB2) present options to the user select, GRUB supports unix-like OS, and chain-load Windows OS, and loads the kernel into memory and supplies it with some parameters.</li>
</ul>
</li>
<li>kernel<ul>
<li>The kernel will decompress itself and will setup essential hardware and memory paging, and calls start_kernel() function, and it will perform the majority of system setups like device and driver initialization, scheduler, idle process and then starts separately in the user space the init process (pid 1).</li>
</ul>
</li>
<li>init<br>-The init it’s scripts executed by shell (sysV, runit) or configuration files that are executed by binaries (upstart, systemd), init has specific levels, that are passed as variables at the call, with consists of specifics set of daemons. These will provide various non-operating system services and structures and form the user environment.</li>
<li>User environment<ul>
<li>The typical desktop environment begins with a daemon that calls everything needed.<br>To shutdown, it’s the inverse, the kernel kills every process, and shutdown.</li>
</ul>
</li>
</ul>
</li>
<li><p>what’s the difference of <code>su -</code> and <code>su</code> ?</p>
<ul>
<li><code>su -</code> switch user with one login shell</li>
<li><code>su</code> switch user without run login shell</li>
</ul>
</li>
<li><p>Linux shell profile login orders</p>
<ul>
<li>user login with shell <ul>
<li>账号和密码——&gt;/etc/profile（全局文件G1）——&gt;/etc/profile.d/（全局脚本目录F1）——&gt; ~/.bash_profile（用户文件U1）——&gt; ~/.bashrc（用户文件U2）——&gt;/etc/bashrc（全局文件G2）</li>
</ul>
</li>
<li>no password and ssh login <ul>
<li>SSH 连接——&gt;  ~/.bashrc（用户文件U2）——&gt;/etc/bashrc（全局文件G2）</li>
</ul>
</li>
</ul>
</li>
<li><p>What does :(){ :|:&amp; };: do on your system?</p>
<ul>
<li>creates a forkbomb</li>
</ul>
</li>
<li><p>How do you catch a Linux signal on a script?</p>
<ul>
<li>using the command trap inside the script</li>
</ul>
</li>
<li><p>How capture the process running time </p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ps -eo pid,lstart,etime | grep 61819</span><br><span class="line"></span><br><span class="line">ps -eo pid,comm,cmd,start,etime | grep -i X</span><br></pre></td></tr></table></figure>

<ul>
<li>How do you find shared library dependencies?</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ldd /fullpath/command</span><br><span class="line">readelf -d /fullpath/command</span><br></pre></td></tr></table></figure>

<ul>
<li><p>What features of the Linux kernel enable Docker to work?</p>
<ul>
<li>CGroups</li>
<li>Namespaces</li>
</ul>
</li>
<li><p>How to dry run ansible playbook and puppet agent commands</p>
<ul>
<li><code> ansible-playbook playbook.yml --check</code></li>
<li><code>puppet agent --noop</code></li>
</ul>
</li>
</ul>
<h2 id="Linux-Hardware-questions"><a href="#Linux-Hardware-questions" class="headerlink" title="Linux Hardware questions"></a>Linux Hardware questions</h2><ul>
<li><p>What is Dell omreport/omconfig comamnd</p>
<ul>
<li>OpenManage Server administartor</li>
</ul>
</li>
<li><p>How to install OMSA(OpenManage Server Administartor)</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># wget -q -O - http://linux.dell.com/repo/hardware/latest/bootstrap.cgi | bash     下载repo源</span><br><span class="line"># yum install -y net-snmp net-snmp-devel net-snmp-utils wget perl OpenIPMI</span><br><span class="line"># yum  -y install srvadmin-all     安装路径：/opt/dell/srvadmin/</span><br><span class="line"># /opt/dell/srvadmin/sbin/srvadmin-services.sh start     启动OMSA</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>Usage of omreport of dell<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">omreport chassis # 显示所有主要组件的常规状态 </span><br><span class="line">omreport chassis memory # 显示内存信息</span><br><span class="line">omreport chassis temps # 显示系统主要组件的温度</span><br><span class="line">omreport storage adisk controller=0 # 查看磁盘陈列中的硬盘状态</span><br><span class="line">omreport storage pdisk controller=0 # 查看物理磁盘信息</span><br><span class="line">omreport storage vdisk controller=0 # 查看虚拟硬盘的状态</span><br><span class="line">omreport storage controller # 查看控制器(即RAID卡)的属性</span><br><span class="line">omreport storage enclosure controller=0 # 查看enclosure的属性</span><br><span class="line">omreport storage battery # 查看电池属性</span><br><span class="line"></span><br><span class="line">omreport chassis info -fmt ssv 分割数据打印出来</span><br></pre></td></tr></table></figure></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost wcy]# omreport chassis info</span><br><span class="line">Chassis Information</span><br><span class="line"></span><br><span class="line">Index                                      : 0</span><br><span class="line">Chassis Name                               : Main System Chassis</span><br><span class="line">Host Name                                  : localhost.localdomain</span><br><span class="line">iDRAC7 Version                             : 1.40.40 (Build 17)</span><br><span class="line">Lifecycle Controller 2 Version             : 1.1.5.165</span><br><span class="line">Chassis Model                              : PowerEdge R420</span><br><span class="line">Chassis Lock                               : Present</span><br><span class="line">Chassis Service Tag                        : 6X8QZY1</span><br><span class="line">Express Service Code                       : 15070774393</span><br><span class="line">Chassis Asset Tag                          : Unknown</span><br><span class="line">Flash chassis identify LED state           : Off</span><br><span class="line">Flash chassis identify LED timeout value   : 300</span><br></pre></td></tr></table></figure>

<ul>
<li>What is HP iLO and LOM<ul>
<li>lights-out management(LOM): Lights-out management (LOM) is a form of out-of-band management. It enables system administrators to connect remotely to servers and other data center infrastructure to monitor and maintain those systems</li>
<li>HP Integrated Lights-Out (iLO)</li>
<li>Dell IDRAC port is 5000</li>
</ul>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">ILO FUNCTION           SOCKET TYPE PORT NUMBER </span><br><span class="line">---------------------- ----------- -----------</span><br><span class="line">Secure Shell (SSH)         TCP        22</span><br><span class="line">Remote Console/Telnet      TCP        23</span><br><span class="line">Web Server Non-SSL         TCP        80</span><br><span class="line">Web Server SSL             TCP        443</span><br><span class="line">Terminal Services          TCP        3389</span><br><span class="line">Virtual Media              TCP        17988</span><br><span class="line">Shared Remote Console      TCP        9300</span><br><span class="line">Console Replay             TCP        17990</span><br><span class="line">Raw Serial Data            TCP        3002</span><br></pre></td></tr></table></figure>



<ul>
<li><p>What is Dell RACADM<br>Remote Access Controller Admin (RACADM) utility is a command-line tool that enables remote or local management of Dell Servers using the iDRAC</p>
</li>
<li><p>List system information </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">echo &quot; -------------------------------------------------------------------&quot;              &gt; /etc/motd</span><br><span class="line">echo &quot;    /etc/motd&quot;                                                                    &gt;&gt; /etc/motd</span><br><span class="line">echo &quot; -------------------------------------------------------------------&quot;             &gt;&gt; /etc/motd</span><br><span class="line">echo &quot; HOST          : `hostname`&quot;                                                      &gt;&gt; /etc/motd</span><br><span class="line">echo &quot; OS            : `head -1 /etc/redhat-release`&quot;                                   &gt;&gt; /etc/motd</span><br><span class="line">echo &quot; KERNEL        : `uname -r`&quot;                                                      &gt;&gt; /etc/motd</span><br><span class="line">echo &quot; CPU           : `cat /proc/cpuinfo | grep &#x27;^model name&#x27; | sort -u | cut -f2 -d&#x27;:&#x27; | sed &#x27;s/^ //&#x27;`&quot; &gt;&gt; /etc/motd</span><br><span class="line">echo &quot; CPU COUNT     : `egrep -c &#x27;^processor&#x27; /proc/cpuinfo`&quot;                           &gt;&gt; /etc/motd</span><br><span class="line">echo &quot; RAM           :  $(( $(cat /proc/meminfo |grep MemTotal |awk &#x27;&#123;print $2&#125;&#x27; ) / (( 1024 * 1000 )) )) GB&quot;                                                      &gt;&gt; /etc/motd</span><br><span class="line"></span><br><span class="line">echo &quot; &quot;                                                                                &gt;&gt; /etc/motd</span><br><span class="line">echo &quot; Manufacturer  : dmidecode -s system-manufacturer`&quot;                               &gt;&gt; /etc/motd                         &gt;&gt; /etc/motd</span><br><span class="line">echo &quot; Serial Number : dmidecode -s system-serial-number&quot;                               &gt;&gt; /etc/motd                         &gt;&gt; /etc/motd</span><br><span class="line">echo &quot; Model         : dmidecode -s system-product-name&quot;                                &gt;&gt; /etc/motd                        &gt;&gt; /etc/motd</span><br><span class="line">echo &quot; BIOS Version  : dmidecoe -s bios-version&quot; 										&gt;&gt; /etc/motd</span><br><span class="line"></span><br><span class="line">_LOMINFO=&quot;`timeout --signal=SIGKILL 10 ipmitool lan print ||  echo &#x27;IP Address     : FAIL&#x27; `&quot;</span><br><span class="line">_LOMIP=&quot;`echo \&quot;$_LOMINFO\&quot; | grep &#x27;IP Address   &#x27;| awk -F&#x27;:&#x27; &#x27;&#123;print $2&#125;&#x27;| tr -d &#x27; &#x27;`&quot;</span><br><span class="line">_LOMFQDN=&quot;$(host -t any -l xxxxxxxx | grep -i $&#123;_SNUM&#125; | awk &#x27;&#123;print $1&#125;&#x27;)&quot;</span><br><span class="line"></span><br><span class="line">cat /etc/motd</span><br></pre></td></tr></table></figure></li>
<li><p>How to build foreman and work with puppet</p>
<ul>
<li>install DHCP server</li>
<li>install DNS server</li>
<li>install vtftp</li>
<li>install forman</li>
<li>configure hammer</li>
<li>configure PXEboot</li>
<li>configure puppet classes</li>
</ul>
</li>
<li><p>How to check and improve I/O issue</p>
<ul>
<li><code>iowait</code> <code>iotop</code> </li>
<li> ensure you have free physical memory so the OS can cache disk blocks in memory</li>
<li>keep your filesystem disk usage below 80% to avoid excessive fragmentation</li>
<li>tune your filesystem</li>
<li>use a battery backed array controller</li>
<li>choose good buffer sizes when performing io operations</li>
</ul>
</li>
<li><p>how to check physical disk driver</p>
<ul>
<li><code>lshw</code> <code>lspci</code></li>
</ul>
</li>
</ul>
<h3 id="Other-hardware-command"><a href="#Other-hardware-command" class="headerlink" title="Other hardware command"></a>Other hardware command</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">//内存</span><br><span class="line"># free -m</span><br><span class="line"># cat /proc/meminfo</span><br><span class="line"># dmidecode -t memory</span><br><span class="line">//CPU</span><br><span class="line"># lscpu</span><br><span class="line"># cat /proc/cpuinfo</span><br><span class="line"># dmidecode -t processor</span><br><span class="line"># dmidecode | grep &quot;CPU&quot; //获取CPU信息</span><br><span class="line">//硬盘</span><br><span class="line"># df -lhP</span><br><span class="line"># lsblk</span><br><span class="line"># fdisk -l</span><br><span class="line"># dmesg|grep sd //查看开机信息里面的磁盘info</span><br><span class="line"># hdparm -I /dev/sda //查看磁盘硬件信息、开启的功能等,信息特别详细 【hdparm需要yum安装】</span><br><span class="line"># smartctl -H /dev/sda //查看硬盘健康状态</span><br><span class="line"># smartctl --all /dev/sda //【smartctl需要yum安装才能用】</span><br><span class="line"># smartctl -h //还有很多有用的参数</span><br><span class="line">//网卡</span><br><span class="line"># lspci|grep -i eth</span><br><span class="line"># ifconfig -a</span><br><span class="line"># ip link show</span><br><span class="line"># ethtool eth0 //显示网卡eth0的详细参数和指标</span><br><span class="line">//系统信息</span><br><span class="line"># dmidecode -t system</span><br><span class="line"># dmidecode | grep&quot;Product&quot;</span><br><span class="line"># dmidecode | grep&quot;Manufacturer&quot; //获取厂商</span><br><span class="line"># dmidecode | grep -B 4 &quot;SerialNumber&quot; | more //获取序号信息</span><br><span class="line"># dmidecode | grep &quot;Date&quot; //获取生产日期</span><br><span class="line">//dmesg和dmidecode还有很多信息，涵盖了全部硬件信息。</span><br><span class="line">//主板</span><br><span class="line"># lspci</span><br><span class="line">//BIOS</span><br><span class="line"># dmidecode -t bios</span><br><span class="line"># dmidecode -q //列出所有有用的信息</span><br><span class="line">//RAID信息</span><br><span class="line"># lspci|grep RAID //列出RAID卡的信息</span><br><span class="line"># megacli64 //需要额外安装</span><br></pre></td></tr></table></figure>

<ul>
<li><p>How to list server hardware information</p>
<ul>
<li><code>dmidecode</code></li>
<li><code>demidecode -s system-manufacturer</code></li>
<li><code>demidecode -s system-serial-number</code>“</li>
<li><code>demidecode -s system-product-name</code>“</li>
<li><code>demidecode -s bios-version</code>“</li>
</ul>
</li>
<li><p>How to add one disk without reboot</p>
<ul>
<li>pvcreate /dev/sdc</li>
<li>vgextend vg1 /dev/sdc</li>
<li>lvextend -r -l +100%FREE /dev/mapper/vg1-root</li>
<li><code>lsblk</code> <code>fdisk -l</code></li>
</ul>
</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://toskachin.github.io/2023/09/04/20230904_kubectl_commands/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="TOSKA">
      <meta itemprop="description" content="10+ IT career and personal memories">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RJ's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2023/09/04/20230904_kubectl_commands/" class="post-title-link" itemprop="url">Kubectl 常用命令</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2023-09-04 00:00:00" itemprop="dateCreated datePublished" datetime="2023-09-04T00:00:00+08:00">2023-09-04</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2023-09-17 10:35:35" itemprop="dateModified" datetime="2023-09-17T10:35:35+08:00">2023-09-17</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/devops/" itemprop="url" rel="index"><span itemprop="name">devops</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>7.5k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>12 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="Kubectl-上下文和配置"><a href="#Kubectl-上下文和配置" class="headerlink" title="Kubectl 上下文和配置"></a>Kubectl 上下文和配置</h2><p>设置 kubectl 命令交互的 kubernetes 集群并修改配置信息。参阅 使用 kubeconfig 文件进行跨集群验证 获取关于配置文件的详细信息。 </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># 显示合并后的 kubeconfig 配置</span><br><span class="line">$ kubectl config view </span><br><span class="line"># 同时使用多个 kubeconfig 文件并查看合并后的配置</span><br><span class="line">$ KUBECONFIG=~/.kube/config:~/.kube/kubconfig2 kubectl config view</span><br><span class="line"># 获取 e2e 用户的密码</span><br><span class="line">$ kubectl config view -o jsonpath=&#x27;&#123;.users[?(@.name == &quot;e2e&quot;)].user.password&#125;&#x27;</span><br><span class="line"># 显示当前的上下文</span><br><span class="line">$ kubectl config current-context    </span><br><span class="line"># 设置默认上下文为 my-cluster-name</span><br><span class="line">$ kubectl config use-context my-cluster-name  </span><br><span class="line"># 向 kubeconf 中增加支持基本认证的新集群</span><br><span class="line">$ kubectl config set-credentials kubeuser/foo.kubernetes.com --username=kubeuser --password=kubepassword</span><br><span class="line"># 使用指定的用户名和 namespace 设置上下文</span><br><span class="line">$ kubectl config set-context gce --user=cluster-admin --namespace=foo \</span><br><span class="line">  &amp;&amp; kubectl config use-context gce</span><br></pre></td></tr></table></figure>

<h2 id="创建对象"><a href="#创建对象" class="headerlink" title="创建对象"></a>创建对象</h2><p>Kubernetes 的清单文件可以使用 json 或 yaml 格式定义。可以以 .yaml、.yml、或者 .json 为扩展名。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"># 创建资源</span><br><span class="line">$ kubectl create -f ./my-manifest.yaml     </span><br><span class="line"># 使用多个文件创建资源</span><br><span class="line">$ kubectl create -f ./my1.yaml -f ./my2.yaml   </span><br><span class="line"># 使用目录下的所有清单文件来创建资源</span><br><span class="line">$ kubectl create -f ./dir    </span><br><span class="line"># 使用 url 来创建资源</span><br><span class="line">$ kubectl create -f https://git.io/vPieo  </span><br><span class="line"># 启动一个 nginx 实例</span><br><span class="line">$ kubectl run nginx --image=nginx  </span><br><span class="line"> # 获取 pod 和 svc 的文档</span><br><span class="line">$ kubectl explain pods,svc                      </span><br><span class="line"># 从 stdin 输入中创建多个 YAML 对象</span><br><span class="line">$ cat &lt;&lt;EOF | kubectl create -f -</span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: Pod</span><br><span class="line">metadata:</span><br><span class="line">  name: busybox-sleep</span><br><span class="line">spec:</span><br><span class="line">  containers:</span><br><span class="line">  - name: busybox</span><br><span class="line">    image: busybox</span><br><span class="line">    args:</span><br><span class="line">    - sleep</span><br><span class="line">    - &quot;1000000&quot;</span><br><span class="line">---</span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: Pod</span><br><span class="line">metadata:</span><br><span class="line">  name: busybox-sleep-less</span><br><span class="line">spec:</span><br><span class="line">  containers:</span><br><span class="line">  - name: busybox</span><br><span class="line">    image: busybox</span><br><span class="line">    args:</span><br><span class="line">    - sleep</span><br><span class="line">    - &quot;1000&quot;</span><br><span class="line">EOF</span><br><span class="line"># 创建包含几个 key 的 Secret</span><br><span class="line">$ cat &lt;&lt;EOF | kubectl create -f -</span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: Secret</span><br><span class="line">metadata:</span><br><span class="line">  name: mysecret</span><br><span class="line">type: Opaque</span><br><span class="line">data:</span><br><span class="line">  password: $(echo &quot;s33msi4&quot; | base64)</span><br><span class="line">  username: $(echo &quot;jane&quot; | base64)</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>
<h2 id="显示和查找资源"><a href="#显示和查找资源" class="headerlink" title="显示和查找资源"></a>显示和查找资源</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"># Get commands with basic output</span><br><span class="line"># 列出所有 namespace 中的所有 service</span><br><span class="line">$ kubectl get services            </span><br><span class="line"></span><br><span class="line"># 列出所有 namespace 中的所有 pod</span><br><span class="line">$ kubectl get pods --all-namespaces  </span><br><span class="line"></span><br><span class="line"># 列出所有 pod 并显示详细信息</span><br><span class="line">$ kubectl get pods -o wide      </span><br><span class="line"></span><br><span class="line"># 列出指定 deployment</span><br><span class="line">$ kubectl get deployment my-dep      </span><br><span class="line"></span><br><span class="line"># 列出该 namespace 中的所有 pod 包括未初始化的</span><br><span class="line">$ kubectl get pods --include-uninitialized      </span><br><span class="line"></span><br><span class="line"># 使用详细输出来描述命令</span><br><span class="line">$ kubectl describe nodes my-node</span><br><span class="line">$ kubectl describe pods my-pod</span><br><span class="line"></span><br><span class="line"># List Services Sorted by Name</span><br><span class="line">$ kubectl get services --sort-by=.metadata.name </span><br><span class="line"></span><br><span class="line"># 根据重启次数排序列出 pod</span><br><span class="line">$ kubectl get pods --sort-by=&#x27;.status.containerStatuses[0].restartCount&#x27;</span><br><span class="line"></span><br><span class="line"># 获取所有具有 app=cassandra 的 pod 中的 version 标签</span><br><span class="line">$ kubectl get pods --selector=app=cassandra rc -o \</span><br><span class="line">  jsonpath=&#x27;&#123;.items[*].metadata.labels.version&#125;&#x27;</span><br><span class="line"></span><br><span class="line"># 获取所有节点的 ExternalIP</span><br><span class="line">$ kubectl get nodes -o jsonpath=&#x27;&#123;.items[*].status.addresses[?(@.type==&quot;ExternalIP&quot;)].address&#125;&#x27;</span><br><span class="line"></span><br><span class="line"># 列出属于某个 PC 的 Pod 的名字</span><br><span class="line"># “jq”命令用于转换复杂的 jsonpath，参考 https://stedolan.github.io/jq/</span><br><span class="line">$ sel=$&#123;$(kubectl get rc my-rc --output=json | jq -j &#x27;.spec.selector | to_entries | .[] | &quot;\(.key)=\(.value),&quot;&#x27;)%?&#125;</span><br><span class="line">$ echo $(kubectl get pods --selector=$sel --output=jsonpath=&#123;.items..metadata.name&#125;)</span><br><span class="line"></span><br><span class="line"># 查看哪些节点已就绪</span><br><span class="line">$ JSONPATH=&#x27;&#123;range .items[*]&#125;&#123;@.metadata.name&#125;:&#123;range @.status.conditions[*]&#125;&#123;@.type&#125;=&#123;@.status&#125;;&#123;end&#125;&#123;end&#125;&#x27; \</span><br><span class="line"> &amp;&amp; kubectl get nodes -o jsonpath=&quot;$JSONPATH&quot; | grep &quot;Ready=True&quot;</span><br><span class="line"></span><br><span class="line"># 列出当前 Pod 中使用的 Secret</span><br><span class="line">$ kubectl get pods -o json | jq &#x27;.items[].spec.containers[].env[]?.valueFrom.secretKeyRef.name&#x27; | grep -v null | sort | uniq</span><br></pre></td></tr></table></figure>

<h2 id="更新资源"><a href="#更新资源" class="headerlink" title="更新资源"></a>更新资源</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">$ kubectl rolling-update frontend-v1 -f frontend-v2.json           # 滚动更新 pod frontend-v1</span><br><span class="line">$ kubectl rolling-update frontend-v1 frontend-v2 --image=image:v2  # 更新资源名称并更新镜像</span><br><span class="line">$ kubectl rolling-update frontend --image=image:v2                 # 更新 frontend pod 中的镜像</span><br><span class="line">$ kubectl rolling-update frontend-v1 frontend-v2 --rollback        # 退出已存在的进行中的滚动更新</span><br><span class="line">$ cat pod.json | kubectl replace -f -                              # 基于 stdin 输入的 JSON 替换 pod</span><br><span class="line"># 强制替换，删除后重新创建资源。会导致服务中断。</span><br><span class="line">$ kubectl replace --force -f ./pod.json</span><br><span class="line"># 为 nginx RC 创建服务，启用本地 80 端口连接到容器上的 8000 端口</span><br><span class="line">$ kubectl expose rc nginx --port=80 --target-port=8000</span><br><span class="line"># 更新单容器 pod 的镜像版本（tag）到 v4</span><br><span class="line">$ kubectl get pod mypod -o yaml | sed &#x27;s/\(image: myimage\):.*$/\1:v4/&#x27; | kubectl replace -f -</span><br><span class="line"># 添加标签</span><br><span class="line">$ kubectl label pods my-pod new-label=awesome        </span><br><span class="line"> # 添加注解</span><br><span class="line">$ kubectl annotate pods my-pod icon-url=http://goo.gl/XXBTWq   </span><br><span class="line"># 自动扩展 deployment “foo”</span><br><span class="line">$ kubectl autoscale deployment foo --min=2 --max=10</span><br></pre></td></tr></table></figure>

<h2 id="修补资源"><a href="#修补资源" class="headerlink" title="修补资源"></a>修补资源</h2><p>使用策略合并补丁并修补资源。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 部分更新节点</span><br><span class="line">kubectl patch node k8s-node-1 -p &#x27;&#123;&quot;spec&quot;:&#123;&quot;unschedulable&quot;:true&#125;&#125;&#x27; </span><br><span class="line"># 更新容器镜像；spec.containers[*].name 是必须的，因为这是合并的关键字</span><br><span class="line">$ kubectl patch pod valid-pod -p &#x27;&#123;&quot;spec&quot;:&#123;&quot;containers&quot;:[&#123;&quot;name&quot;:&quot;kubernetes-serve-hostname&quot;,&quot;image&quot;:&quot;new image&quot;&#125;]&#125;&#125;&#x27;</span><br><span class="line"># 使用具有位置数组的 json 补丁更新容器镜像</span><br><span class="line">$ kubectl patch pod valid-pod --type=&#x27;json&#x27; -p=&#x27;[&#123;&quot;op&quot;: &quot;replace&quot;, &quot;path&quot;: &quot;/spec/containers/0/image&quot;, &quot;value&quot;:&quot;new image&quot;&#125;]&#x27;</span><br><span class="line"># 使用具有位置数组的 json 补丁禁用 deployment 的 livenessProbe</span><br><span class="line">$ kubectl patch deployment valid-deployment  --type json   -p=&#x27;[&#123;&quot;op&quot;: &quot;remove&quot;, &quot;path&quot;: &quot;/spec/template/spec/containers/0/livenessProbe&quot;&#125;]&#x27;</span><br></pre></td></tr></table></figure>

<h2 id="编辑资源"><a href="#编辑资源" class="headerlink" title="编辑资源"></a>编辑资源</h2><p>在编辑器中编辑任何 API 资源。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"># 编辑名为 docker-registry 的 service</span><br><span class="line">$ kubectl edit svc/docker-registry           </span><br><span class="line"># 使用其它编辑器</span><br><span class="line">$ KUBE_EDITOR=&quot;nano&quot; kubectl edit svc/docker-registry</span><br></pre></td></tr></table></figure>

<h2 id="Scale-资源"><a href="#Scale-资源" class="headerlink" title="Scale 资源"></a>Scale 资源</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"># Scale a replicaset named &#x27;foo&#x27; to 3</span><br><span class="line">$ kubectl scale --replicas=3 rs/foo       </span><br><span class="line"># Scale a resource specified in &quot;foo.yaml&quot; to 3</span><br><span class="line">$ kubectl scale --replicas=3 -f foo.yaml     </span><br><span class="line"># If the deployment named mysql&#x27;s current size is 2, scale mysql to 3</span><br><span class="line">$ kubectl scale --current-replicas=2 --replicas=3 deployment/mysql  </span><br><span class="line"># Scale multiple replication controllers</span><br><span class="line">$ kubectl scale --replicas=5 rc/foo rc/bar rc/baz</span><br></pre></td></tr></table></figure>

<h2 id="删除资源"><a href="#删除资源" class="headerlink" title="删除资源"></a>删除资源</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"># 删除 pod.json 文件中定义的类型和名称的 pod</span><br><span class="line">$ kubectl delete -f ./pod.json        </span><br><span class="line"># 删除名为“baz”的 pod 和名为“foo”的 service</span><br><span class="line">$ kubectl delete pod,service baz foo      </span><br><span class="line"># 删除具有 name=myLabel 标签的 pod 和 serivce</span><br><span class="line">$ kubectl delete pods,services -l name=myLabel       </span><br><span class="line"># 删除具有 name=myLabel 标签的 pod 和 service，包括尚未初始化的</span><br><span class="line">$ kubectl delete pods,services -l name=myLabel --include-uninitialized   </span><br><span class="line"># 删除 my-ns namespace 下的所有 pod 和 serivce包</span><br><span class="line">$ kubectl -n my-ns delete po,svc --all</span><br></pre></td></tr></table></figure>

<h2 id="与运行中的-Pod-交互"><a href="#与运行中的-Pod-交互" class="headerlink" title="与运行中的 Pod 交互"></a>与运行中的 Pod 交互</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"># dump 输出 pod 的日志（stdout）</span><br><span class="line">$ kubectl logs my-pod  </span><br><span class="line"> # dump 输出 pod 中容器的日志（stdout，pod 中有多个容器的情况下使用）</span><br><span class="line">$ kubectl logs my-pod -c my-container      </span><br><span class="line"># 流式输出 pod 的日志（stdout）</span><br><span class="line">$ kubectl logs -f my-pod             </span><br><span class="line"># 流式输出 pod 中容器的日志（stdout，pod 中有多个容器的情况下使用）</span><br><span class="line">$ kubectl logs -f my-pod -c my-container</span><br><span class="line"># 交互式 shell 的方式运行 pod</span><br><span class="line">$ kubectl run -i --tty busybox --image=busybox -- sh  </span><br><span class="line"> # 连接到运行中的容器</span><br><span class="line">$ kubectl attach my-pod -i    </span><br><span class="line"># 转发 pod 中的 6000 端口到本地的 5000 端口</span><br><span class="line">$ kubectl port-forward my-pod 5000:6000   </span><br><span class="line">  # 在已存在的容器中执行命令（只有一个容器的情况下）</span><br><span class="line">$ kubectl exec my-pod -- ls /          </span><br><span class="line"># 在已存在的容器中执行命令（pod 中有多个容器的情况下）</span><br><span class="line">$ kubectl exec my-pod -c my-container -- ls /    </span><br><span class="line"># 显示指定 pod 和容器的指标度量</span><br><span class="line">$ kubectl top pod POD_NAME --containers</span><br></pre></td></tr></table></figure>

<h2 id="与节点和集群交互"><a href="#与节点和集群交互" class="headerlink" title="与节点和集群交互"></a>与节点和集群交互</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"># 标记 my-node 不可调度</span><br><span class="line">$ kubectl cordon my-node       </span><br><span class="line"># 清空 my-node 以待维护</span><br><span class="line">$ kubectl drain my-node    </span><br><span class="line"># 标记 my-node 可调度</span><br><span class="line">$ kubectl uncordon my-node             </span><br><span class="line"> # 显示 my-node 的指标度量</span><br><span class="line">$ kubectl top node my-node    </span><br><span class="line">$ kubectl cluster-info          </span><br><span class="line"> # 将当前集群状态输出到 stdout</span><br><span class="line">$ kubectl cluster-info dump                                                               </span><br><span class="line"> # 将当前集群状态输出到 /path/to/cluster-state</span><br><span class="line">$ kubectl cluster-info dump --output-directory=/path/to/cluster-state  </span><br><span class="line"># 如果该键和影响的污点（taint）已存在，则使用指定的值替换</span><br><span class="line">$ kubectl taint nodes foo dedicated=special-user:NoSchedule</span><br></pre></td></tr></table></figure>

<h2 id="set-命令"><a href="#set-命令" class="headerlink" title="set 命令"></a>set 命令</h2><p>配置应用的一些特定资源，也可以修改应用已有的资源<br>使用 kubectl set –help查看，它的子命令，env，image，resources，selector，serviceaccount，subject。</p>
<p>语法：resources (-f FILENAME | TYPE NAME) ([—limits=LIMITS &amp; —requests=REQUESTS]</p>
<h2 id="kubectl-set-resources-命令"><a href="#kubectl-set-resources-命令" class="headerlink" title="kubectl set resources 命令"></a>kubectl set resources 命令</h2><p>这个命令用于设置资源的一些范围限制。<br>资源对象中的Pod可以指定计算资源需求（CPU-单位m、内存-单位Mi），即使用的最小资源请求（Requests），限制（Limits）的最大资源需求，Pod将保证使用在设置的资源数量范围。<br>对于每个Pod资源，如果指定了Limits（限制）值，并省略了Requests（请求），则Requests默认为Limits的值。</p>
<p><code>可用资源对象包括(支持大小写)：replicationcontroller、deployment、daemonset、job、replicaset。</code></p>
<p>例如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 将deployment的nginx容器cpu限制为“200m”，将内存设置为“512Mi”</span><br><span class="line">$ kubectl set resources deployment nginx -c=nginx --limits=cpu=200m,memory=512Mi</span><br><span class="line"># 设置所有nginx容器中 Requests和Limits</span><br><span class="line">$ kubectl set resources deployment nginx --limits=cpu=200m,memory=512Mi --requests=cpu=100m,memory=256Mi</span><br><span class="line"># 删除nginx中容器的计算资源值</span><br><span class="line">$ kubectl set resources deployment nginx --limits=cpu=0,memory=0 --requests=cpu=0,memory=0</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://toskachin.github.io/2023/09/02/20230902_hexo_migration/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="TOSKA">
      <meta itemprop="description" content="10+ IT career and personal memories">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RJ's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2023/09/02/20230902_hexo_migration/" class="post-title-link" itemprop="url">Hexo Blog电脑快速迁移</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2023-09-02 00:00:00 / 修改时间：09:27:56" itemprop="dateCreated datePublished" datetime="2023-09-02T00:00:00+08:00">2023-09-02</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/blog/" itemprop="url" rel="index"><span itemprop="name">blog</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>378</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>1 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h1><p>如何快速的将一个Hexo Blog移动到另外一台电脑</p>
<h1 id="Tech"><a href="#Tech" class="headerlink" title="Tech"></a>Tech</h1><ul>
<li>hexo </li>
<li>hexo theme</li>
<li>github</li>
</ul>
<h2 id="Install-Steps"><a href="#Install-Steps" class="headerlink" title="Install Steps"></a>Install Steps</h2><h3 id="Install-hexo"><a href="#Install-hexo" class="headerlink" title="Install hexo"></a>Install hexo</h3><ul>
<li><code>brew install npm</code></li>
<li><code>brew install hexo</code></li>
<li>copy original folder to new location </li>
<li>make sure new laptop ssh key added into github</li>
<li><code>hexo clean &amp;&amp; hexo g &amp;&amp; hexo d</code></li>
</ul>
<h2 id="Useful-hexo-commands"><a href="#Useful-hexo-commands" class="headerlink" title="Useful hexo commands"></a>Useful hexo commands</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">hexo new page &quot;about&quot;</span><br><span class="line">hexo --config _config.yml</span><br><span class="line">hexo generate --watch</span><br><span class="line"></span><br><span class="line">hexo server</span><br><span class="line">hexo generate</span><br><span class="line">hexo deploy</span><br><span class="line"></span><br><span class="line">hexo clean &amp;&amp; hexo g &amp;&amp; hexo d</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://toskachin.github.io/2023/08/13/shell_from_zero_to_hero./">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="TOSKA">
      <meta itemprop="description" content="10+ IT career and personal memories">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RJ's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2023/08/13/shell_from_zero_to_hero./" class="post-title-link" itemprop="url">一文让你shell从狗熊变英雄</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2023-08-13 17:29:35" itemprop="dateCreated datePublished" datetime="2023-08-13T17:29:35+08:00">2023-08-13</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2023-09-17 10:29:48" itemprop="dateModified" datetime="2023-09-17T10:29:48+08:00">2023-09-17</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/sysadmin/" itemprop="url" rel="index"><span itemprop="name">sysadmin</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>1.8k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>3 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <ul>
<li><a href="#shell-from-zero-to-hero">Shell From Zero To Hero</a><ul>
<li><a href="#simply-level-questions">Simply Level Questions</a><ul>
<li><a href="#%E6%8F%8F%E8%BF%B0linux%E7%B3%BB%E7%BB%9F%E4%BB%8E%E5%BC%80%E6%9C%BA%E5%88%B0%E7%99%BB%E9%99%86%E7%95%8C%E9%9D%A2%E7%9A%84%E5%90%AF%E5%8A%A8%E8%BF%87%E7%A8%8B">描述Linux系统从开机到登陆界面的启动过程</a></li>
<li><a href="#%E6%8F%8F%E8%BF%B0linux%E4%B8%8B%E8%BD%AF%E9%93%BE%E6%8E%A5%E5%92%8C%E7%A1%AC%E9%93%BE%E6%8E%A5%E7%9A%84%E5%8C%BA%E5%88%AB">描述Linux下软链接和硬链接的区别</a></li>
</ul>
</li>
<li><a href="#middle-level-questions">Middle Level Questions</a><ul>
<li><a href="#%E6%8F%8F%E8%BF%B0linux%E4%B8%8B%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%E7%9A%84%E5%8E%9F%E7%90%86">描述Linux下文件删除的原理</a></li>
<li><a href="#%E8%AF%B7%E7%AE%80%E8%BF%B0%E5%9F%BA%E7%A1%80%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8Fgrep%E9%AB%98%E7%BA%A7%E5%8F%82%E6%95%B0%E7%9A%84%E4%BD%BF%E7%94%A8">请简述基础正则表达式grep高级参数的使用</a></li>
<li><a href="#%E8%AF%B7%E7%AE%80%E8%BF%B0%E5%9F%BA%E7%A1%80%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8Fsed%E9%AB%98%E7%BA%A7%E5%8F%82%E6%95%B0%E7%9A%84%E4%BD%BF%E7%94%A8">请简述基础正则表达式sed高级参数的使用</a></li>
<li><a href="#awk">AWK</a></li>
</ul>
</li>
<li><a href="#hard-level-questions">Hard Level Questions</a></li>
</ul>
</li>
</ul>
<h1 id="Shell-From-Zero-To-Hero"><a href="#Shell-From-Zero-To-Hero" class="headerlink" title="Shell From Zero To Hero"></a>Shell From Zero To Hero</h1><h2 id="Simply-Level-Questions"><a href="#Simply-Level-Questions" class="headerlink" title="Simply Level Questions"></a>Simply Level Questions</h2><h3 id="描述Linux系统从开机到登陆界面的启动过程"><a href="#描述Linux系统从开机到登陆界面的启动过程" class="headerlink" title="描述Linux系统从开机到登陆界面的启动过程"></a>描述Linux系统从开机到登陆界面的启动过程</h3><ul>
<li><p>开机BIOS自检，加载硬盘。</p>
</li>
<li><p>读取MBR,MBR引导。</p>
</li>
<li><p>grub引导菜单(Boot Loader)。</p>
</li>
<li><p>加载内核kernel。</p>
</li>
<li><p>启动init进程，依据inittab文件设定运行级别</p>
</li>
<li><p>init进程，执行rc.sysinit文件。</p>
</li>
<li><p>启动内核模块，执行不同级别的脚本程序。</p>
</li>
<li><p>执行/etc/rc.d/rc.local</p>
</li>
<li><p>启动mingetty，进入系统登陆界面。</p>
</li>
</ul>
<h3 id="描述Linux下软链接和硬链接的区别"><a href="#描述Linux下软链接和硬链接的区别" class="headerlink" title="描述Linux下软链接和硬链接的区别"></a>描述Linux下软链接和硬链接的区别</h3><p>在Linux系统中，链接分为两种，一种是硬链接（Hard link），另一种称为符号链接或软链接（Symbolic Link）。</p>
<ul>
<li><p>默认不带参数的情况下，ln创建的是硬链接，带-s参数的ln命令创建的是软链接。</p>
</li>
<li><p>硬链接文件与源文件的inode节点号相同，而软链接文件的inode节点号，与源文件不同，</p>
</li>
<li><p>ln命令不能对目录创建硬链接，但可以创建软链接。对目录的软链接会经常使用到。</p>
</li>
<li><p>删除软链接文件，对源文件和硬链接文件无任何影响。</p>
</li>
<li><p>删除文件的硬链接文件，对源文件及软链接文件无任何影响。</p>
</li>
<li><p>删除链接文件的源文件，对硬链接文件无影响，会导致其软链接失效（红底白字闪烁状）。</p>
</li>
<li><p>同时删除源文件及其硬链接文件，整个文件才会被真正的删除。</p>
</li>
<li><p>很多硬件设备的快照功能，使用的就是类似硬链接的原理。</p>
</li>
<li><p>软链接可以跨文件系统，硬链接不可以跨文件系统。</p>
</li>
</ul>
<h2 id="Middle-Level-Questions"><a href="#Middle-Level-Questions" class="headerlink" title="Middle Level Questions"></a>Middle Level Questions</h2><h3 id="描述Linux下文件删除的原理"><a href="#描述Linux下文件删除的原理" class="headerlink" title="描述Linux下文件删除的原理"></a>描述Linux下文件删除的原理</h3><p>Linux系统是通过link的数量来控制文件删除的，只有当一个文件不存在任何link的时候，这个文件才会被删除。一般来说每个文件两个link计数器来控制i_count和i_nlink。当一个文件被一个程序占用的时候i_count就加1。当文件的硬链接多一个的时候i_nlink也加1。删除一个文件，就是让这个文件，没有进程占用，同时i_link数量为0。</p>
<h3 id="请简述基础正则表达式grep高级参数的使用"><a href="#请简述基础正则表达式grep高级参数的使用" class="headerlink" title="请简述基础正则表达式grep高级参数的使用"></a>请简述基础正则表达式grep高级参数的使用</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">常用参数：</span><br><span class="line"></span><br><span class="line">-v排除匹配内容，</span><br><span class="line"></span><br><span class="line">-e支持扩展的正则表达式，</span><br><span class="line"></span><br><span class="line">-i忽略大小写，</span><br><span class="line"></span><br><span class="line">-o输出匹配的内容（只是一块，不是行），</span><br><span class="line"></span><br><span class="line">--color=auto 匹配内容显示颜色，</span><br><span class="line"></span><br><span class="line">-n 在行首显示行号。</span><br><span class="line"></span><br><span class="line">特殊字符注意事项：</span><br><span class="line"></span><br><span class="line">^(尖括号)word ：表示搜索以word开头的内容。</span><br><span class="line"></span><br><span class="line">word$ 表示搜索以word结尾的内容。</span><br><span class="line"></span><br><span class="line">^$    表示的是空行，不是空格。</span><br><span class="line"></span><br><span class="line">.     代表且只能代表任意一个字符。非正则表达式其他功能（当前目录，加载文件）</span><br><span class="line"></span><br><span class="line">/     转义字符，让有着特殊身份意义的字符，脱掉马甲，还原原型。例如.只表示原始小数点意义。</span><br><span class="line"></span><br><span class="line">*    表示重复0个或多个前面的一个字符。不代表所有。</span><br><span class="line"></span><br><span class="line">.*   表示匹配所有的字符。^.*表示以任意字符开头。</span><br><span class="line"></span><br><span class="line">[任意字符如abc] 匹配字符集内任意一个字符[a-z]。 [^abc] ^在中括号里面是非的意思，不包含之意。意思就是不包含a或b或c的行。</span><br><span class="line"></span><br><span class="line">&#123;n，m&#125; 表示重复n到m次前一个字符。｛n｝至少n次，多了不限。｛n｝N次，｛，m｝至多m次，少了不限。</span><br><span class="line"></span><br><span class="line">注：使用grep或sed要对｛｝转义。即｛｝.egrep就不需要转义了。</span><br></pre></td></tr></table></figure>

<h3 id="请简述基础正则表达式sed高级参数的使用"><a href="#请简述基础正则表达式sed高级参数的使用" class="headerlink" title="请简述基础正则表达式sed高级参数的使用"></a>请简述基础正则表达式sed高级参数的使用</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">解答：</span><br><span class="line"></span><br><span class="line">-n取消默认输出</span><br><span class="line"></span><br><span class="line">-p 打印</span><br><span class="line"></span><br><span class="line">-d删除</span><br><span class="line"></span><br><span class="line">-e允许多项编辑</span><br><span class="line"></span><br><span class="line">sed取行，要特别注意sed -n &#x27;s###g&#x27; filename 的使用，sed的( )的功能可以记住正则表达式的一部分，其中，为第一个记住的模式即第一个小括号中的匹配内容，第二记住的模式，即第二个小括号中的匹配内容，sed最多可以记住9个。</span><br><span class="line"></span><br><span class="line">实际字符的选取最好要唯一，正则表达式是贪婪的，总是尽可能的匹配更远的符合匹配的内容。另外注意字符串中的空格。</span><br></pre></td></tr></table></figure>

<h3 id="AWK"><a href="#AWK" class="headerlink" title="AWK"></a>AWK</h3><h2 id="Hard-Level-Questions"><a href="#Hard-Level-Questions" class="headerlink" title="Hard Level Questions"></a>Hard Level Questions</h2>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://toskachin.github.io/2023/08/08/202308_trap_for_tmpscripts/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="TOSKA">
      <meta itemprop="description" content="10+ IT career and personal memories">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RJ's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2023/08/08/202308_trap_for_tmpscripts/" class="post-title-link" itemprop="url">Bash中处理临时文件的正确方法-trap/mktemp</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2023-08-08 09:00:00" itemprop="dateCreated datePublished" datetime="2023-08-08T09:00:00+08:00">2023-08-08</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2023-09-17 10:35:17" itemprop="dateModified" datetime="2023-09-17T10:35:17+08:00">2023-09-17</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/sysadmin/" itemprop="url" rel="index"><span itemprop="name">sysadmin</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>2.3k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>4 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="临时文件生成最佳实践"><a href="#临时文件生成最佳实践" class="headerlink" title="临时文件生成最佳实践"></a>临时文件生成最佳实践</h1><p>创建前检查文件是否已经存在。<br>确保临时文件已成功创建。<br>临时文件必须有权限的限制。<br>临时文件要使用不可预测的文件名。<br>脚本退出时，要删除临时文件（使用trap命令）。</p>
<h2 id="mktemp-命令的用法"><a href="#mktemp-命令的用法" class="headerlink" title="mktemp 命令的用法"></a>mktemp 命令的用法</h2><p>mktemp命令就是为安全创建临时文件而设计的。虽然在创建临时文件之前，它不会检查临时文件是否存在，但是它支持唯一文件名和清除机制，因此可以减轻安全攻击的风险。</p>
<p>直接运行mktemp命令，就能生成一个临时文件。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[centos@ip-172-31-29-167 ~]$ trap</span><br><span class="line">trap -- &#x27;&#x27; SIGTSTP</span><br><span class="line">trap -- &#x27;&#x27; SIGTTIN</span><br><span class="line">trap -- &#x27;&#x27; SIGTTOU</span><br><span class="line">[centos@ip-172-31-29-167 ~]$ ls -l</span><br><span class="line">total 0</span><br><span class="line">[centos@ip-172-31-29-167 ~]$ ls -l /tmp/tmp.gpngJKqhxB</span><br><span class="line">-rw-------. 1 centos centos 0 Aug  8 13:44 /tmp/tmp.gpngJKqhxB</span><br></pre></td></tr></table></figure>

<p>为了保证脚本退出时临时文件被删除，可以使用trap命令指定退出时的清除操作</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line"></span><br><span class="line">trap &#x27;rm -f &quot;$TMPFILE&quot;&#x27; EXIT</span><br><span class="line"></span><br><span class="line">TMPFILE=$(mktemp) || exit 1</span><br><span class="line">echo &quot;Our temp file is $TMPFILE&quot;</span><br></pre></td></tr></table></figure>
<h2 id="mktemp-命令参数"><a href="#mktemp-命令参数" class="headerlink" title="mktemp 命令参数"></a>mktemp 命令参数</h2><p><code>-d参数可以创建一个临时目录。</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[centos@ip-172-31-29-167 ~]$ mktemp -d</span><br><span class="line">/tmp/tmp.JMOmb1dbXS</span><br></pre></td></tr></table></figure>

<p><code>-p参数可以指定临时文件所在的目录。默认是使用$TMPDIR环境变量指定的目录，如果这个变量没设置，那么使用/tmp目录</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@ip-172-31-29-167 centos]# mktemp -p /home/</span><br><span class="line">/home/tmp.exqlVMkNSc</span><br></pre></td></tr></table></figure>

<h2 id="trap-命令的用法"><a href="#trap-命令的用法" class="headerlink" title="trap 命令的用法"></a>trap 命令的用法</h2><p>trap命令用来在 Bash 脚本中响应系统信号。<br>最常见的系统信号就是 SIGINT（中断），即按 Ctrl + C 所产生的信号。trap命令的-l参数，可以列出所有的系统信号。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@ip-172-31-29-167 centos]# trap -l</span><br><span class="line"> 1) SIGHUP	 2) SIGINT	 3) SIGQUIT	 4) SIGILL	 5) SIGTRAP</span><br><span class="line"> 6) SIGABRT	 7) SIGBUS	 8) SIGFPE	 9) SIGKILL	10) SIGUSR1</span><br><span class="line">11) SIGSEGV	12) SIGUSR2	13) SIGPIPE	14) SIGALRM	15) SIGTERM</span><br><span class="line">16) SIGSTKFLT	17) SIGCHLD	18) SIGCONT	19) SIGSTOP	20) SIGTSTP</span><br><span class="line">21) SIGTTIN	22) SIGTTOU	23) SIGURG	24) SIGXCPU	25) SIGXFSZ</span><br><span class="line">26) SIGVTALRM	27) SIGPROF	28) SIGWINCH	29) SIGIO	30) SIGPWR</span><br><span class="line">31) SIGSYS	34) SIGRTMIN	35) SIGRTMIN+1	36) SIGRTMIN+2	37) SIGRTMIN+3</span><br><span class="line">38) SIGRTMIN+4	39) SIGRTMIN+5	40) SIGRTMIN+6	41) SIGRTMIN+7	42) SIGRTMIN+8</span><br><span class="line">43) SIGRTMIN+9	44) SIGRTMIN+10	45) SIGRTMIN+11	46) SIGRTMIN+12	47) SIGRTMIN+13</span><br><span class="line">48) SIGRTMIN+14	49) SIGRTMIN+15	50) SIGRTMAX-14	51) SIGRTMAX-13	52) SIGRTMAX-12</span><br><span class="line">53) SIGRTMAX-11	54) SIGRTMAX-10	55) SIGRTMAX-9	56) SIGRTMAX-8	57) SIGRTMAX-7</span><br><span class="line">58) SIGRTMAX-6	59) SIGRTMAX-5	60) SIGRTMAX-4	61) SIGRTMAX-3	62) SIGRTMAX-2</span><br><span class="line">63) SIGRTMAX-1	64) SIGRTMAX</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ trap [动作] [信号]</span><br></pre></td></tr></table></figure>
<p>上面代码中，”动作”是一个 Bash 命令，”信号”常用的有以下几个。<br>常见信号</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">HUP：编号1，脚本与所在的终端脱离联系。</span><br><span class="line">INT：编号2，用户按下 Ctrl + C，意图让脚本中止运行。</span><br><span class="line">QUIT：编号3，用户按下 Ctrl + 斜杠，意图退出脚本。</span><br><span class="line">KILL：编号9，该信号用于杀死进程。</span><br><span class="line">TERM：编号15，这是kill命令发出的默认信号。</span><br><span class="line">EXIT：编号0，这不是系统信号，而是 Bash 脚本特有的信号，不管什么情况，只要退出脚本就会产生。</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ trap &#x27;rm -f &quot;$TMPFILE&quot;&#x27; EXIT</span><br><span class="line">#命令中，脚本遇到EXIT信号时，就会执行rm -f &quot;$TMPFILE&quot;。</span><br></pre></td></tr></table></figure>


<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line"></span><br><span class="line">trap &#x27;rm -f &quot;$TMPFILE&quot;&#x27; EXIT</span><br><span class="line"></span><br><span class="line">TMPFILE=$(mktemp) || exit 1</span><br><span class="line">ls /etc &gt; $TMPFILE</span><br><span class="line">if grep -qi &quot;kernel&quot; $TMPFILE; then</span><br><span class="line">  echo &#x27;find&#x27;</span><br><span class="line">fi</span><br></pre></td></tr></table></figure>

<p>上面代码中，不管是脚本正常执行结束，还是用户按 Ctrl + C 终止，都会产生EXIT信号，从而触发删除临时文件<br>注意，trap命令必须放在脚本的开头。否则，它上方的任何命令导致脚本退出，都不会被它捕获。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://toskachin.github.io/2023/05/26/Nomad_and_Kubernetes/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="TOSKA">
      <meta itemprop="description" content="10+ IT career and personal memories">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RJ's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2023/05/26/Nomad_and_Kubernetes/" class="post-title-link" itemprop="url">Nomad 和 Kubernetes 区别</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2023-05-26 11:33:00" itemprop="dateCreated datePublished" datetime="2023-05-26T11:33:00+08:00">2023-05-26</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2023-09-17 10:31:05" itemprop="dateModified" datetime="2023-09-17T10:31:05+08:00">2023-09-17</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/devops/" itemprop="url" rel="index"><span itemprop="name">devops</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>3.6k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>6 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Nomad-vs-Kubernetes"><a href="#Nomad-vs-Kubernetes" class="headerlink" title="Nomad vs. Kubernetes"></a>Nomad vs. Kubernetes</h1><p>现今Containor技术比较流行的是Kubernetes, 后起之秀Nomad也风行起来，那么两者的区别是啥</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Kubernetes is an orchestration system for containers originally designed by Google, now governed by the Cloud Native Computing Foundation (CNCF) and developed by Google, Red Hat, and many others. Kubernetes and Nomad support similar core use cases for application deployment and management, but they differ in a few key ways. Kubernetes aims to provide all the features needed to run Linux container-based applications including cluster management, scheduling, service discovery, monitoring, secrets management and more. Nomad only aims to focus on cluster management and scheduling and is designed with the Unix philosophy of having a small scope while composing with tools like Consul for service discovery/service mesh and Vault for secret management.</span><br><span class="line"></span><br><span class="line">The following characteristics generally differentiate Nomad from Kubernetes:</span><br></pre></td></tr></table></figure>

<h2 id="Simplicity"><a href="#Simplicity" class="headerlink" title="Simplicity"></a>Simplicity</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Kubernetes is designed as a collection of more than a half-dozen interoperating services which together provide the full functionality. Coordination and storage is provided by etcd at the core. The state is wrapped by API controllers which are consumed by other services that provide higher level APIs for features like scheduling. Kubernetes supports running in a highly available configuration but is operationally complex to setup.</span><br><span class="line"></span><br><span class="line">Nomad is architecturally much simpler. Nomad is a single binary, both for clients and servers, and requires no external services for coordination or storage. Nomad combines a lightweight resource manager and a sophisticated scheduler into a single system. By default, Nomad is distributed, highly available, and operationally simple.</span><br></pre></td></tr></table></figure>

<h2 id="Flexible-Workload-Support"><a href="#Flexible-Workload-Support" class="headerlink" title="Flexible Workload Support"></a>Flexible Workload Support</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">While Kubernetes is specifically focused on Linux containers, Nomad is more general purpose. Nomad supports virtualized, containerized and standalone applications, including Docker, Java, IIS on Windows, Qemu, etc. Nomad is designed with extensible drivers and support will be extended to all common drivers.</span><br></pre></td></tr></table></figure>

<h2 id="Consistent-Deployment"><a href="#Consistent-Deployment" class="headerlink" title="Consistent Deployment"></a>Consistent Deployment</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">A full Kubernetes installation for a production environment is time consuming, operationally complex, and resource intensive. An increasing number of implementations are created by the Kubernetes community to mitigate these challenges, such as minikube, kubeadm, k3s, and more. These trimmed versions of Kubernetes offer easier adoption for development and testing, but lead to inconsistency in capabilities, configuration, and management when moving into production.</span><br><span class="line"></span><br><span class="line">In contrast to Kubernetes&#x27; fragmented distributions, Nomad as a single lightweight binary can be deployed in local dev, production, on-prem, at the edge, and in the cloud in a consistent manner, and provides the same operational ease-of-use across all environments.</span><br></pre></td></tr></table></figure>

<h2 id="Scalability"><a href="#Scalability" class="headerlink" title="Scalability"></a>Scalability</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Kubernetes documentation states that they support clusters up to 5,000 nodes and 300,000 total containers. As the environment grows, the interoperating components with different constraints compound the operational complexity. Even operators at Google revealed the significant challenges of managing the system at scale. The lack of maturity in the Federation project and the additional overhead of managing a centralized management plane also make it a hard experience to deploy a distributed system that spans multiple clusters.</span><br><span class="line"></span><br><span class="line">Nomad has been proven to scale to cluster sizes that exceed 10,000 nodes in real-world production environments. It can be deployed across multiple availability zones, regions, and data centers with a single cluster or multiple clusters. Nomad is designed to natively handle multi-cluster deployments without the overhead of running clusters on clusters. This makes it easier to scale the application deployment across multiple datacenters, regions, and clouds with no additional complexity.</span><br><span class="line"></span><br><span class="line">Nomad has performed strenuous benchmark on scalability with 1 million container challenge in 2016 and 2 million container challenge in 2020. These tests are aimed to validate Nomad&#x27;s architectural design and ensure that Nomad performs under the most extreme requirements.</span><br></pre></td></tr></table></figure>

<h2 id="Nomad-command-examples"><a href="#Nomad-command-examples" class="headerlink" title="Nomad command examples"></a>Nomad command examples</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">nomad node status</span><br><span class="line"></span><br><span class="line">nomad job run pytechco-redis.nomad.hcl</span><br><span class="line"></span><br><span class="line">nomad job stop -purge pytechco-employee</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://toskachin.github.io/2023/05/17/memo_2023may/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="TOSKA">
      <meta itemprop="description" content="10+ IT career and personal memories">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RJ's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2023/05/17/memo_2023may/" class="post-title-link" itemprop="url">国民对于疫情后经济复苏信心的丢失，路在何方</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2023-05-17 06:33:00" itemprop="dateCreated datePublished" datetime="2023-05-17T06:33:00+08:00">2023-05-17</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2023-09-17 10:31:19" itemprop="dateModified" datetime="2023-09-17T10:31:19+08:00">2023-09-17</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/memo/" itemprop="url" rel="index"><span itemprop="name">memo</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>612</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>1 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="新闻要点"><a href="#新闻要点" class="headerlink" title="新闻要点"></a>新闻要点</h2><ul>
<li>国内各种经济数据下滑，楼市价格加速下跌</li>
<li>年轻人失业率创新高<br><img src="/memo_2023may/china_data_may.png" alt="image"><br>国内一季度各类数据如期下滑，尽管官方给出各种掩饰也无法抹去其背后真正原因国民对于经济复苏的信心的丢失<br>楼市房价的加速下跌，包括一二线城市，提前还贷，银行贷款放不出去，央行继续印钞，承接的还是国企各类城投，资金无法流向市场<blockquote>
<p>北京方面，北京4月份二手房网签13928套，环比下降了40.5%。上海二手房成交量4月份不到1.8万套，相比于3月份的2.4万套环比下降了26%，比2月份的1.9万套还要低。</p>
</blockquote>
</li>
</ul>
<blockquote>
<p>4月份，城镇失业数据达到了年度最低的5.2，并且已经接近了疫前数据。但是与此同时，16-24岁青年失业率首次突破20%。</p>
</blockquote>
<h2 id="究其背后原因"><a href="#究其背后原因" class="headerlink" title="究其背后原因"></a>究其背后原因</h2><ul>
<li><p>国内风气的歪曲，都想赚快钱，无人愿意去干实业支撑国家运转，踏踏实实的工作，谁都想撞到风口捞一把，管理机构不对于风气的正确引导，恐怕难以改变现状，案例：</p>
<ul>
<li>挖呀挖呀黄老师突然网红，一周收入百万十年收入，辞职下海。</li>
<li>格力董密孟羽童，一个自以为格力内定接班人被开除，吐槽董秘都是干的杂活，兴趣在直播。</li>
</ul>
</li>
<li><p>环境太优渥，年轻人自命不凡，没有经历过社会的洗礼，“00后整顿职场”的新闻经常看到，任性离职，受不得气</p>
<ul>
<li>孟羽童案例<ul>
<li>从她个人简历来看家庭优渥，从小在国际学校读书一路保守，没有经历过国内高考的洗礼，不知道何为现实</li>
<li>吐槽格力董秘就是一个打杂的活，当年同龄的女霸总们在干什么？董明珠离开单亲的孩子，寸步不离跟着经销商催账；张兰跑去国外打黑工，跟男人一起抗海鲜。<br><img src="/memo_2023may/mengyutong.png" alt="image"></li>
</ul>
</li>
</ul>
</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">TOSKA</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">238k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">6:37</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div id="site-runtime">
  <span class="post-meta-item-icon">
    <i class="fa fa-clock-o"></i>
  </span>
  <span id="runtime"></span>
</div>

<script language="javascript">
  function isPC() {
    var userAgentInfo = navigator.userAgent;
    var agents = ["Android", "iPhone", "SymbianOS", "Windows Phone", "iPad", "iPod"];
    for (var i = 0; i < agents.length; i++) {
      if (userAgentInfo.indexOf(agents[i]) > 0) {
        return false;
      }
    }
    return true;
  }

  function siteTime(openOnPC, start) {
    window.setTimeout("siteTime(openOnPC, start)", 1000);
    var seconds = 1000;
    var minutes = seconds * 60;
    var hours = minutes * 60;
    var days = hours * 24;
    var years = days * 365;
      start = new Date("2021-08-19 09:00:00 +0800");
    var now = new Date();
    var year = now.getFullYear();
    var month = now.getMonth() + 1;
    var date = now.getDate();
    var hour = now.getHours();
    var minute = now.getMinutes();
    var second = now.getSeconds();
    var diff = now - start;

    var diffYears = Math.floor(diff / years);
    var diffDays = Math.floor((diff / days) - diffYears * 365);
    var diffHours = Math.floor((diff - (diffYears * 365 + diffDays) * days) / hours);
    var diffMinutes = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours) / minutes);
    var diffSeconds = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours - diffMinutes * minutes) / seconds);

    if (openOnPC) {
      document.getElementById("runtime").innerHTML = "Running: " + diffYears + " years " + diffDays + " days " + diffHours + " hours " + diffMinutes + " mins " + diffSeconds + " secs";
    } else {
      document.getElementById("runtime").innerHTML = "Running: " + diffYears + "y " + diffDays + "d " + diffHours + "h " + diffMinutes + "m " + diffSeconds + "s";
    }
  }

  var showOnMobile = false;
  var openOnPC = isPC();
  var start = new Date();
  siteTime(openOnPC, start);

  if (!openOnPC && !showOnMobile) {
    document.getElementById('site-runtime').style.display = 'none';
  }
</script>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@next-theme/pjax@0.5.0/pjax.min.js" integrity="sha256-3NkoLDrmHLTYj7csHIZSr0MHAFTXth7Ua/DDt4MRUAg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script><script src="/js/pjax.js"></script>

  
<script src="/js/third-party/search/local-search.js"></script>




  
  <script data-pjax async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





</body>
</html>
